Transcription & Summarize : とりあえず読書会 SwiftUI Tutorials #50

はい、ではとりあえずご紹介を始めていきましょう。今日も引き続き、安静した Swift UI テストリアルの行動を見直して、直しているところは直していく。 まあ、リファクタリングと呼ばれるやつですね。まあ、それもほとんどね、なんか落ち着いたような感じもしてきて、もはやなんか振り返りつつ、 要所をね、解説するみたいなのがそんな形になってますが、一応、まあリファクタリングですよね。そういったリファクタリング作業になります。 で、そういった方々もね、意外とまあ慣れていかないと難しいなというところがあると思うので、まあこういった機会でね、 他の人がどんな感じでリファクタリングやってるんだろうみたいな、そんな感じの気持ちで見てもらえれば、まあいいのかなと思いますね。 結構難しいんですよね、リファクタリングって。あの、自分の考えって意外とまとまってるようでまとまってなくて、この時はこれがいいと思ったけど、別の日にはね、別の方が良いと思って、まあ戻ってきたりとかをやると思うんですけど、 まあ慣れてないうちは、あの自分の理想というものが見えてないうちは、まあそういう場合なんでね、生きたり死ながら自分にしっくりするもの。 自分にしっくりと言ってもね、いろんな理屈といったものも意識して、理にかなったら、ゆっくりかんですかね、そんなところを目指していくことになるのかなという気がして、それをね、あの、パソコンというか、あの、いくになるのか、やっぱりそういったAPIデザインガイドライン、あれはよくできてますね。 とても、なんか、結構まとまってるんですけど、すごく大事なところ、考え方の基準になるようなね、そんなところがしっかり書かれてるんで、あれはじっくりと読んでみると、あの、リファクタリングとかもしやすくなると思うんでね、おすすめですね。 さて、まあ、そんな感じでやっていきましょう。はい、じゃあ、さっそく報道に行きましたが、ここは終わりましたね。ランドマークディテールのMacOSまでは終わった。なので、ついでにランドマークディテールのウォッチOSね。 では、プロジェクトのスキームもウォッチOSにしといて、プレビューもね、見ながらやっていくのがいいでしょう。やはり、ファクタリングしてるとね、デザインが崩れていたりというのをね、前回結構話しましたけど、こんな感じになるので、プレビューができるなら、やっといたほうがいいですね。 ZUIのこのプレビュー機能すごくいいですよね。もう、SwiftUIというかXcodeか。さてさて、まあ、こんな感じで見ていきますが、まあここで、なんだかんだ言って、未だにまだ迷っている、バインディングのバーはどういったアクセスコントロールにすべきか、というところですが、まあ、自分の中のね、今のところの感覚としては、プライベートセットにしておいたほうが、あっという間にステートとね、バランスが良いし、言語使用としてもね、ぴったりいい感じな気がするんで、これはとりあえずしばらくは、えーと、プライベートセットを自分がつけていってみて、差し支えることはないと思うんですよね。差し支えた場合には、 えーと、あ、大丈夫ですね。ビルド通った。じゃあプレビューも大丈夫なはず。 あ、でもプレビューの設定が思い浮かんのが狭いんですね。こっち、GIMPラウンドマーク4D、ALS2ビルド、やってるもののことと違いそうね。 オミブレットファイドモジュールディペンデンシスウィートコンパイラープラグイン。 これなんか別の問題になっている気がしますね。Xcodeをどうすれば直るみたいなそういう問題に見える。わからないけど、そんなんでちょっとやってみますが。 こうして、プレビューをね、起動して、意外とあるんですよね。 意外とあるんですよね。 まだ直ってないんで、わからないですけど、まあまあ、Xcodeに起動し直すと直るみたいなことはありがちなんでね。 で、動いた。はい、じゃあこれ見ていきますけど、ライブラリセットはいいですね。 で、ボディのスクロールビューでサークルイメージデキスト。この辺もまあシンプルに並んでますけどね。 他のビューでいろいろいじったので、これもやっぱり、他のOSのビューに並ばせていった方がわかりやすい気がする。 えーと、そうする上で、でもパッドがちょっと印象違いますね。なので名前だけから違ってくるかな。 えーと、でもここがヘッダーパートみたいな感じで、ヘッダーエリアか、こんな感じでこの前使いましたね。 なのでここをヘッダーエリアってランドマークパークとしてとか、ここまでヘッダーってしてましたね、この前ね。 えーと、こんな感じか。地図に行くとスクロール大変なんだこれ。 えーと、まあこれは、もうしょうがない感じな気がしますね。 しょうがないっていうのは、ちょっとリアルがこうなっているからっていう感じですね。 これでヘッダーとコンテンツっていう名前の付け方をしてましたけど、Apple Watch的にはそんな感じじゃないですね。 だから、こうするとヘッダービューというよりはメインビューですかね。こんな感じに見える。 あとはイメージですよね。イメージとタイトル、タイトル、そうね、イメージ、タイトル。 それらを含めてコンテンツがランドマーク、ディテールのコンテンツ。 なので、ちょっとここのディバイダーの手前まで、ディバイダーも含むんですがね。 ディバイダーを含んで、これらのテキストまで、ここまでか。 これをコンテンツ、仮に名付けましょう。仮にというか完全にか。コンテンツ。 で、このコンテンツ何かっていうのが、えーと下にね、エクステンションが個人的に好みなので、ランドマーク、ディテール。 これに対し拡張をかけて、バーコンテンツとして、サムビューを返して。 で、それでコンテンツはこれですね。で、もうなんかいろいろエラーが出てるのは、あ、そっか、ビュービルダーですね。 うん、ロバティラがね、これを使って、違う、リザルトビルダーね。リザルトビルダーを使わないとこういう書き方できない。 で、できたのがこれですね。崩れていなそうでですね。 で、その後別にはなくてもいいですけど、同じノリでいくとね。 ま、コンテントビューにしようかな、ここは。なんかすごく他のOSと触れてますけどね。 っていうか、コンテントビュー、コンテントエリアにしようかな。 Mac OSと同じに合わせて、コンテントエリア。 で、ここもね、1つのマップビューを表示するだけなんですけど、統一感の関係でね。 ここで、えーと、マップエリアっていう風にすると、 コンテントエリアとマップエリアがディバイダーでね、区切られてるよっていうそういった表現になってくれるんで、 ま、まあ、見やすいでしょうきっと。 で、ビュービルダーで、えーと、バーで、あ、エクステンション違う。 エクステンションはここでの話なんで、プライベートエクステンションですね。 で、そうして、これでバーで、えーと、なんだっけ、イメージエリアだけっていうね。 これで、ま、マップだ。マップビュー。 ま、こんな感じ。押してあげると、マップビューはマップ表示するだけですよ。 スケールとフィットでってなってますけど、ここは抜きにしてね、こっちのボディで見ると、 コンテントエリアとマップエリアをディバイダーしたものですよっていう風に、 プライアスくなりますよね。ディバイダーはいいでしょう。 で、今、押し通したところで、イメージ、サークルイメージと、ネーム、 Favorite、それと、パークとステートが並んだやつ。 この辺は相互ですね。どうしようかな。 これは、えーと、タイトルとサブタイトル。 ヘッダーとサブヘッダーにしましたっけ。他のOSのとき。マックOS。 あまりにもね、違うと統一感なくなって、コードの家族性が、 同じコードなのに、落ちてしまうみたいなね。こんなことになってしまいかねないんで。 マックOSのに習うと、サマリー。サマリーは違うな。 えーと、あ、でもサマリーなんですけどね。サマリーの中が、イメージエリアとヘッダーエリアですね。 で、それで、タイトルエリアとサブタイトルエリア。 この名前。なのでこれに習ってみましょう。 そうすると、そもそものイメージとネーム、エブリッドとアークステート。 この辺りはサマリーという名前をつけてましたね。 なので、サマリーエリアにしようかな。ここ。 うんうん。あ、でもサマリーエリア、コンテンツエリア、コンテンツエリア、サマリーエリア。 あ、だが、つまり、マックOSと合わせるなら、ここがサマリーエリアですね。 サマリーエリア。で、そした上で、タイトルエリア。 これがランドマークネームとイズフェエブリッド。 これを、だからつまり、タイトルエリアという風にして、このタイトルエリアは何かというと、 ここで、アットビュービルダーでバー、タイトルエリアとして、サムービューですね。 で、ここに今コピーしたやつを貼ってきてあげる。タイトルOKですね。 次に、サマリーのサブタイトルですね。ランドマークのマークとステートこれを、 アットビュービルダーでバーサブタイトルエリア。 サムービューですね。そしてこうやって定義を張ってあげて、 これでサブタイトルもできた。 なので、サマリーエリアはイメージと、タイトルエリアとサブタイトルエリア。 そうするとさっきと同じ発想で、他細かい話になりますが、 ここにイメージを貼るよという場所なので安泰ですけど、 イメージエリアみたいな名前をつけてあげて、 その上でアットビュービルダーでバーでイメージエリア、 という風にやってあげると、これでOKですね。 こんな風にしてあげるとできて良かったのは、 サマリーはイメージとタイトルと、そこに分割線を入れて、 サブタイトル。で、サマリーは元々ここ、ボディを見ると、 色々エリアに対して、V作は、別にV作いらなくないかな。 VとUIだと、いってみますか。崩れるのかな。ここベビューね。大丈夫ですね。 それで、サマリーエリアのイメージとタイトルと、 ディバイドしてサブタイトルですよね。 その後にディバイドが入って、マップエリアが続くよっていう、 そんな感じで安当直入なOP的になりましたね。 そして、さっき言った通りサマリーエリアは、 イメージとタイトルと分割線とタイトル。分かりやすいですね。 これでね、タイトルエリアはどんな表示なのかなとか、 要はここを見ていて、ここねちゃんとタイトルエリアだと認識してたとすると、 なんかここがおかしいぞみたいな、そんな風になったときに、 タイトルエリアだけは定期を見れば、ここがおかしいみたいな感じで直していけるんでね。 そんな感じで、マップビュー、マップエリアはこれ。 イメージエリアはこれ。 タイトルエリアはこれ。ランドマークのネームと、 ランドマークのisfavoriteを特定するものですね。 サブタイトルはパークトステートで終わり。 直すところが他になさそうな感じがしますね。 で、これ、良い。次行きましょう。ランドマークリスト。 他に直せるところ、いろいろありそうかな。 ランドマークリストビューになっていて、モデルデータをエンバイロメントと持っていって、 プライベートバーでステートがいろいろあって、 エレクトリックランドマークIDがオプショナル。 データとしてない可能性も補助するとオプショナルですよね。 ディスプレイングランドマークIDは現在表示しているね。 ランドマークのID、これはIDを配列で保持して、これは最初は空。 で、後で表示するものを設定していく。 フィルターはこのフィルターと、 フィルターはランドマークリストのフィルターか。 ディスプレイ、フィルター、フィルター。 フィルターで良いのか、分かりにくかったんですけど、大丈夫か。 フィルターですよね。 ランドマークリストのフィルター。 ここにもXコードのプロジェクトナビゲーターのフィルターが付いてますからね。 これで良いんでしょうかね。 名前の区間差を忘れなければ大丈夫ですね。 フィルター。 で、ショーイングメニューがフォルスになって、メニューを表示していない状態。 で、バインディングでさっきから言っているプライベートセット。 これがガトーなのではない仮説。 それはとりあえず自治しておいて、ショーイングプロファイルをブルーにして、 それでフィルターとランドマークスは、バインディングされたランドマークの配列を返すようにして、 フィルターとランドマークス。 これはアップデート、これデバッグメッセージですね。 そろそろいらないですね。消しとこう。 それでランドマークスは、モデルデータからバインディングランドマークスを取って、 ディスプレイIDがランドマークIDを含む場合。 つまり、これらは表示されるものですよね。 それでバインディングランドマークを返すことによって、表示されるべきもののバインディングをリターンしてあげる。 若干わかりにくいですけどね。バインディングを作り直さないと教えられないので、こういう風にしているという感じで。 とにかくちょっと複雑な感じになっていますけど、これを掃除してフィルターとランドマークスという名前が付いているということは、 使うときにはフィルタリングが応用されたランドマークのリストをバインディングとして得られるようになっているので、 そこを踏まえてコードを読めばわかるでしょう。なのでOK。 こんな風に、ややこしいものを考えなきゃいけないときに、考えた末の結果を関数名につけておくという風にすると、 使う人はコードをいろいろ書いてあるけど、そうなんだということで書くことができるので、 結構細かく分けていくというのはカード属性の面で意外と良くなったりする。 あとはランドマークバイイティーでIDを元にランドマークを取り出す。 ここもいいですね。バインドされたものを取る。 セレクティブランドマークは、セレクティブIDを買った場合にはそれを取る。 ここはマップバースでできますけどね。今回はガードとリターンが普通の機能でやっていますが、 マップでやるとすると、セレクティブランドマークIDがオプショナルなので、 セレクティブランドマークIDマップでランドマークの、ランドマークバイイティーだから、 ランドマークバイイティーが多いかどうか。 そしてこれにリターンをかけてあげればこれで完成なので、 どっちが好みかですよね。上と下ね。 コメントアウトした部分と上がなってる。 ランドマーク、ランドマークが、バイイティー、ランドマーク、ランドマーク違ったか。 ランドマークバイイティー自分の関数か。 ちょっと間違った感じですね。 これはどうするといいんだ。何かことやるしかないのかな。 こうしてあげて、ランドマークバイイティーとして並べる。 こんな感じですね。これが正解ですかね。 あ、違った。ランドマークバイイティーがオプショナルで、これマップだから。 これフラットマップですね。 ちょっと戻ってしまった。 けれども、これでも書くことができる。 ただ、慣れてないとわかりにくいのと、 あと、そういう人はオプショナルの名前が変数に表されにくい。 なので、セレクティブランドマークIDがオプショナルなのかどうかっていうのが、 わかんない。表向き。 なので、そこでいきなりマップを使った時に、 これを配列と誤認することはあまりないと思うんですけど、 それがオプショナルであって、 さらにオプショナルがどういったマップを持っているということを学習していないと、 ちょっと似た思い方になっちゃうんで、 それを短いからとして書いてもいいんですけど、 ここまで学習コストを高める必要はないかなっていう、 そんな気分もするんで、 ここではカードで、 カードで書いてあれば、 セレクティブランドマークIDがオプショナルであるってことが分かる。 2フレットオープンなんでね。 そうすると余計なことを考えなくていいし、 これで2フレットだった時には答えもね、 2フレットにすればいいし、 みたいな感じにできるんで、 ここは1行で納めずに、 4行で納めておいた方が、 なんとなく読みやすいかなって気はする。 あとアップデートランドマークリスト、 これはディスプレイングランドマークIDと、 フィルターかけてIDで更新する。 これもフィルターをかけて配列を作って、 もう1回IDにマップする配列を作るんだったら、 これは1回ランドマークスマップにレイジ使ったら良さそうですね。 そうしてあげると、フィルターとマップが 遅延評価になるので、 フィルターして有用な値だった時にはマップして、 それを配列に納入を遅刻するみたいな感じなんで、 フィルターとマップが独立しないで済むはずなんですよ。 レイジはいいデータかかるかもしれないですね。 そして準備を終えた上で、4D。 バインダブルでモデルデータをバインドできるように、 エンバイドエンドでもらったやつをバインドできるようにした上で、 ノビゲーションスクリプトビューで、 エレクションはディレクティブランドマークIDと関連するようにした上で、 フィルターとランドマークをそれぞれ回していって、ローを表示する。 このシミュレーターのそれぞれ、これですね。 ここはシンプルにまとまってて良さそうですね。 で、フィルターが変わった時には、ランドマークリストを更新する。 これは最適化ですよね。 お気に入り状態がオンのやつだけを出している中で、 オフにしたときにリストがあるケースだと、 それをうっかりお気に入りボタンを押したときに、 そこで消えちゃって、もう一回戻すためには探さないといけないというね。 そういうことが起こらないように、ディスプレイランドマークIDで管理するように、 どこかでリファクタリングを上げた。 リファクタリングというか、使用変更ですかね。 そんな感じなので、フィルターが変化するまではリストは高くなり保持して、 フィルター設定が変わった時に改めて入れ上げるということがここですね。 アニメーションでフィルターとランドマークスにアラップとかいうか、 それに対してアニメーションを投稿しオフィクスミができた。 あ、そっか。ウォッチOSで長押しをすると個別のタップができなくなる。 これは面倒だからやめようって言ったんだ。 今これ、シミュレーターでやると具体的にわかると思うんですけど、 これが押したときに項目が出て、戻るときは、 このボタンで戻るのが変ですね。 こんなもんかな。 こういった部分なんですけど、これ長押ししても今何もならないですが、 これを有効化しておくと、 ロファイル画面が出てくるっていうそういった作りに途中でリファクタリングしましたね。 ここね。コメントアウトができてるね。ウォッチOSですよね。 ここなんでウォッチOS色が出てないんだろう。 今ビルドしてみますか。ビルドじゃなくて今こっちのビルドが見えたね。 エミュレーターが動いててもらって、それで長押ししてみる。 えっと、これでビルドがビルドじゃないや。 シミュレーターが動くはずなので、動いたら長押し。 長押し反応しないと。 あの字なんですね。だって色変わってないですね。 色変わってない状態ですね。 えーと、Ranomax for OSですよね。 あ、美しい違う。これはやばい。これどうやるんだ。 怖いねこれね。コンパイラーって結構タイプとかを防いでくれるのをね、期待しているところに。 これはウォッチOSが長かったからだ。怖いなこれ。 で、それで早速ビルドになってる。 超フェイバリットオンリーがスコープにない。 えーと、超フェイバリットオンリー。 あ、ないね。確かに。 超フェイバリットオンリーがない。どうなると。 超フェイバリットオンリーは何に使ってるんだ。 えーと、リストメニュー。 あー、リストメニューか。確かに。 超フェイバリットオンリーなんてないんだ。 わかんなくない。 えーと、これのスクロールは終わりだ。 ちょっと待って。またね。 あれ、止まったよ。 あれ、止めるのかな。 あ、ここだからだ。 また止まった。 えーと、お気に入り。 超フェイバリットオンリーがない。 確かにない。 あ、フィルターがあった。 フィルターだ。 フィルターの中に移動したんじゃない。 確か。 超フェイバリットオンリーありましたね。 だからこれがステートだから、ファインディングに渡すとして、 超フェイバリットオンリーですけど、これがフィルターですね。 これでよかった。 そうするとこんな感じになって、長押しすると、出ないか。 あ、出た出た。これね。メニューが出てくる。 つまり、長押しにするとリストここをタップするっていうことが、これ今押したんですけど、できなくなってるっていうね。 だからリストメニューを出すためには、それをやらなければならないという、そういった問題ですね。 これはやり方はよくわかんないな。 リストメニューでやるけれど、これは独自のモディファイヤーで、 定義を見ると、モディファイヤーでリストメニューモディファイヤーですね。 これは何をやっているかというと、ここで、これはプロファイルとかのボタンを表示か、リストモディファイヤーとかのボタンですね。 ボタンが押されたときには、ドローイングプロファイルとか、あんまり大したことはやってなかったですね。 こうすると、これはこれとしていいのか。 だからこれ長押しだったときと、普通のグリップだったときね。 それで使い分けてかつセレクトするっていう、そういった感じ、それを期待する。 そうしたときには、リストメニューの中でモディファイヤーで、 リストメニューモディファイヤーで、オンロングプレステスティアってあるじゃないですか。 それで、オンタップテスティア、これをちょっとプリントしてみましょうか。 これが機械通りの動きを見せるかどうかですね。 今回は色々いじるんで、ちょっとプレビューを固定しておいて、どこでも見れるようにしましょう。 これでいっぱい押すと、出ますね、アイコンね。 長押しすると、もうメニューきますね。これでいけるのかな。 こうするとできることとしては、選択したときに、セレクティブランドマークIDですね。 おそらくね、想像で勝手に気分でやるんですけど、セレクティブランドマークIDはintのオプショナルですね。 これをバインディングしてあげて、ここですね、ビョーイングメニューとかの前ですかね。 バインディング、セレクティブランドマークIDとして、バインディング。 セレクティブランドマークIDとして、バインディング、intオプショナル、こんな感じですかね。 これがもうちょっと必要になって、リストメニューモディファイア、この中でもバインディングでね、これを持ってあげる。 バインディング、プライベートセットね。 それで、こんな風に持たせて、それを持たせたらここですね。できるのかな、これ。 ボディでリストメニューモディファイアできると選んでいるもの。 違うね、なんかここまでやったけど、違ってそうですね。 セレクティブランドマークID、ちょっとプリントしてみましょうか。 それもそれでダメな気がしますね。 タップジェスチャー。タップジェスチャーがされたときに、普通に選択したいわけですよ。 要は、セレクティブランドマークIDのアンラップ。 ランドマークIDがUnsafelyUnlockedGetOnlyProperty。 それはいいんですけど、なんかダメらしいとか。 おかしいですね。だから、つまり、選べることとしてはリストで、 だから、ザファリ。 ザファリじゃない方がいいのかな。 ザファリを持っていきますね、ここへ。 こうした上で、SwiftUIで。 そうね、リストセレクション変更コードから。 こんな感じで見ていくと、なんか見るかな。 ここから変更するには、リストの初期状態でセレクトパインディングを使用し、 パインディング先のステージの変数を更新する。 これはいいですね。 だから、タップジェスチャーは、SwiftUIセレクションというか、 セレクション変更コードからでいいか。 それで、何だっけ? 忘れちゃった。 セレクションで、忘れちゃった。 SwiftUIでリストでセレクション変更コードからで。 何だっけ?ちょっとコードに戻りましょうか。 パインディングじゃなくて、現在のローになるのかな。 リストメニューだからリストローですね。 コードから現在の量を取得。 オンチェンジ。セレクティブパインディングとオンチェンジ。 オンチェンジは、オンチェンジモディファイヤーを監視する。 オンチェンジ発動してるのかなという問題が出てきますよね。 セレクティブランドマークIDで、 ここをとりあえず渡しておきますか。 セレクティブランドマークIDとして、 セレクティブランドマークID。 ここがなんか違うらしい。 リストモディファイヤーで、 セレクティブランドマークID。 バインディング、バインディング。 これも違うらしい。 オンリブプロパティ。 プロパティなサインできません。 サインしてない感じしますね。 うん、なんかおかしくなりますね。 とりあえず、オンタップジェスチャーは無しにして、 .onChangeで、ob、セレクティブID、ランドマークIDか。 で、アクションとしては、今回はプリントするだけにしますね。 こうして、プリント。 で、ダブルフォードで、ストリングインターポレーションして、 同様にストリングインターポレーションして、 ここですね。 プリントがなんか変なとこにありましたね。 ホールドバリューとニューバリュー。 で、ここでね、ホールドバリューとニューバリュー。 これで、あれ、良くない。 丸カッコが抜けてますね。 こうして、またダブルフォード、オンチェンジで、 インスタンスメソッド、これが、バインディングコンファームイコータブル。 バインディングインターがイコータブル。 あ、そっか、オンチェンジだからか。 なるほどね。 だから、オンチェンジで、ラップでないのかな。 それで、ホールドバリュー、ニューバリューが、 タミネティブストリングリテラル。 四方的なところ持ちますね。 で、オッケーで、ホールドバリューとニューバリューは、 オプショナルの可能性があるから、どうするか。 っていう感じかな。 えっと、デバッグディスクリプション フォーオプショナルバリュー。 そうですね。 なので、これをオプショナルでもいいんですよ。 っていうための一つの方法としては、 ここに、えーと、ここに、まず、エニーですね。 こうしてあげると、大丈夫。 で、ここの丸カッコがいらない。 うん。 で、あとは文字出しとかなんて、分かんないですね。 ここの隣、ここに、ここにしますかね。 これで、レビューを見て、タップでね、どういう反応をしますか。 シングル、タップ、それが大通りにね。 聞いてくれば、オッケーという感じですが、 レビューが進まないな、コンパイウェアか。 ここか。 えーと、セレクティッドモディファイヤー。 セレクティッドランドマーク。 セレクティッドランドマークが、バインディングIDですよね。 で、それで、あー、ここ全然違った。 バインディングが付いてるね。 なので、ここは完全に、バインディングイントではなくて、イントで良いと。 で、そうすると、グラフトバリューなどのハズがなく、 これで、よしとして、代表が。 あれ、まだダメだ。ビルドアイラーかな。 ビルドアイラーを先にやって直しますか。 押したときに、どこがダメなのか。ここか。 バインディングイント、バインディングイント、メニュー。 これ、何をやったんだろうね。 バインディングイントを渡してるけど、そんなものは渡さないですね。 バインディングイントじゃなくて、 セレクティッドランドマークIDですよね。 なので、今のやつは、ここ。 キャラを入れて、セレクティッドランドマークID。 IDを渡す必要はなかったんですよね。 コードを見るとね。 できたら、一回押すと、バリューはチェンジしないですね。 なので、いくつかの意味を直すには、 押したときに、タップが発動するようにして、 その中で、どこが押されたのかを判断できれば、 そのまま渡せると。 渡せると、このクリックが効いてくると。 なるほど。これは調べないとわからないですね。 フィックスミーせっかくだから取りたいですもんね。 これ実際のプロダクトとかだったとすると、 法数とか、期間の余裕とか、相手の予算とかね。 フィックスミーというよりは、 ドゥドゥとかで、ドゥドゥじゃないかな。 残しておいたりするんでしょうけど。 ここなら、オンタップができたのを思うとやりたいけど、 オンタップしたセルを知るには、 セルに対してオンタップを書かないとダメかな。 やってみますか。そういった感じで。 これをやるとすると、ちょっとスイスと言われ、 そんなにこのJRでやってる程度なんで、 全然違うことをやりそうな雰囲気を感じるんですけど、 まず一番最初のゴールはね、できれば良いってのがあって、 それが本当に正しいやり方なのかどうかっていうのは、 そんなと考えていけば、まずは良い。 学習の段階としてはね、と思うんで、 まあまずはね、無理やりでもやって、それでね、 誰かがこんな無駄なコードを書いてるみたいに思ったら、 そこで学べば良い。 ありがたい。こんな感じでやっていきましょう。 という感じなので、逆に言うとね、 そのやり方ヤバいでしょみたいなことを教えてもらえると、 自分の成長の機会になってとても良い。 まあまあいいや、とりあえず。 なので、オンチェンジは期待できなかった、 あちらはここフィルターだからこれはいいんだ。 だから、Appleのランドマークリストで落ちて、リストで、 まず、バインディングがいらなそうですね。 あとで気付くか。まずは、リストメニューで、 これでロングタップがね、実装されていたんでしたよね。 確かね。ロングタップ、オンチェンジで、 ニューカギ、オールド、バリュー、セレクティブ。 オールド、バリュー、セレクティブ、ここですよね。 これは書き換えたから無し。 オンタップテストはこれを使っても、 オンチェンジが発動しないので無し。 その代わり、リストメニュー、モディファイアで、 ロングプレスでリストが出るようにして、 これはロングプレスというか、 リストメニューの話だからこれで完結ですよね。 それとは別で、セルのタップを実現してあげて、 普段は何もしなくてもできるんですが、 今回はどうするか。リストバーって、 セレクティブランドマークIDもNOなんですけど、 ランドマークローのランドマーク、 これが表示されたいんですよね、押したときね。 だからこれでオンタップテストをやって、 セレクティブランドマークIDを書き換えたからって、 ダメそうですよねって気がする。 ってことはどうするんだこれ。 これをGPTに聞けばいいのかな。 41でランドマークローがあって、 これがナビゲーションスプリットビューですね。 それでナビゲーションスプリットビュー41でランドマークが見られて、 それのローを表示して、 ローが表示されてるんだ。 ローが表示されてる中で、 セレクティブランドマークIDが変示したとき。 ローがあるでしょ。 このローにオンタップジェスチャーを付ける回転じゃなくて、 プリントでここで何かを持ち出しつつ、 ローだけどここでランドマークIDを表示してあげると、 これでプレビューできたのかな。 押してあげたときに、 これを一体通りの感じになったんで、 オンタップジェスチャーの中で、 セレクティブランドマークIDですね。 これに対してランドマークそのローのID。 これをセットしてあげるよっていう風にやったら、 リバーサーモンクリコー出た感じじゃないですか。 スクロールをFモードしたいんですが、 マップの表示良くないですね。 普通のApple Watchだとどう動かすんだろ。 戻った。スタートブロック。 スタートブロックですよね。いいですね。 それで、ルクートトレイルが出ますね。 できましたね、これで。 ここ長押しするとメニューがあって、 ちゃんと長押ししてる。 出た出た。できましたね。 その上でリファクトリング続けていきますが、 この辺のリストはしょうがないのかな。 ただちょっとこの辺コードを重ねていきますよね。 なのでこれを分割する手は十分にあるのかなと思ったけど、 ランドマークロー。リストの中で、 そうね。ローエリア。ロービュー。 ローなんだろう。4チェンジとかあるから、 これまとめていくと全部解けることになっちゃうんで、 4、4、1、4、1か。4、1それぞれでランドマークだから、 ローかな。ここはこれでいいのかな。 ローでしょ。4、1、4、1。 セレクティブランドマークIDだから、 ここのリスト4、1は必要で、 4、1は回すやつなんで、 リストに対して、リスト、リスト、リストに対して、 リスト、アイテムズ。 アイテムズエリア。これも変ですね。 どうしようかな。ここ分割するか。 分割してみたいですね。リストの中で、 リストの中のリスト、また名前の雰囲気が変わっちゃうんですけど、 リストの中でリストブロックっていう風にしてあげると、 リストに対してリストのリストセレクションで、 ここから回すから、リストブロックをこの外にね。 このエクステンションはリストミニマムウィズド。 これプライベートで良さそうですね。 プライベートエクステンション。 どれとランドマークリスト。 今見てるランドマークリストって全部共通か。 全部共通の中で、こういう感じか。 だからリストブロックは全部共通ですね。 なのでリストブロックの全部共通は、 ここがビルダー。こればっかり定義してるので、 もうちょっと上行きますか。 このチョッキングライでプライベートレッド。 ここで行く。全部共通であることが分かってほしいから、 この下にしましょう。 プライベートエクステンションでランドマークリスト。 ここでリストブロックブロックで、 これがビュービューダーですね。 ビュービューダー。これでベースとしてOK。 リストが出るでしょ。これでタブ。 ここは過剰な気持ちないようなんでね。 こんなことしなくてもいい気がするけど。 ポイントのリストでこのタップジェスチャー。 これがウォッチOSだけですね。やるのね。 だからifOS、watchOSだった場合にはタップジェスチャーを考慮する。 という風にするとこれでApple Watch完成で、 なのでもう一度ランドマークローでリストローとか作っておけますか。 そうするとフォーインの中身これをカットして、 それでリストローをランドマークみたいな風なインターフェースにして、 やっとビュービューダーにして、 ファンクションリストローをランドマークで、 ランドマークだったですよね。 これでランドマークローに出して、 ランドマークをここでバインディングか。 バインディングを渡すからここで取るのがバインディングですね。 バインディング、ランドマーク。 これでここがバインディングランドマークで、 これがUnexpected、ローでリストアップ戻し、 モノリティサムビューですね。 押してあげて、できたできた。 そうするとバインディングでローを出して、 そのローがウォッチOSに限ってはね、 オンタップジェスチャーで制御するようになって、 それでOKですね。 ここIDのか。このIDはなんとバインディング先のIDが取れてるのかな。 このIDが取れるんだ。よくできてますね。 こうすることによって、どうなんですかね。 とにかくこのボディの方がスリムな形になって、 若干見てですね、リストのセレクションがこれで、 リストの部分はリストブロックですよって書き方になってて、 このリストブロック何やってんのって、 リストと一緒に知りたい感じがなんとなく 自分は感じるんで、ここ過剰かもしれないですね。 なのでこれやめよう。リストブロックはやめて、 リストブロックになったものはちゃんとリストの中に戻してあげて、 こうすると若干長いですけどね。 この方がリストとフォーイッチでセブンみたいなものですからね。 その上でリストローだけ後ろに回してあげればこれでOKでしょう。 この定義とかフォーイッチの定義を見ると、 フォーイッチでコンテンツとかコンテンツってパラメーターで渡せばいいから、 ランドマーク渡してもランドマークリストローで出してるじゃないですか。 だからこれ多分ここでフォーイッチのコンテンツとして、 コンテンツとしてリストローを書いてもOKですよね。 多分あれって言うのかな。 これがこのカッコとそのカッコ。 この並カッコ。この並カッコ。 この並カッコがない。この並カッコがOK。 これがOKだ。 フォーイッチに対して、 これ丸太1行でまとまってくんないけど、 これでフォーイッチに対してフィルターランドマークIDとコンテンツ。 こんな風なパラメーターを渡しているような感じ。 これをクロージャー作ってリストローに対してダイレクトに ランドマークを渡すって方が分かりやすいって感じる人もいるでしょうし、 こっちは慣れてればコンテンツとしてリストローでフォーで、 フォーイッチに対してランドマークが渡ってくる。 ちょっと分かりにくかったかもしれないですね。 こんなに難しなクロージャーの形で大人しくやった方が、 こっちの方が分かりやすいかもしれないですね。 ランドマークIDでフォーイッチかけてランドマークを リストローに渡してあげるとね。こうしましょう。 これでいい感じにまとまって、オンチェンジでフィルターが変わったときには、 アップデートランドマークリスト、デフォルトフィルターに フィルターが使われていないことが判明したので、これ消しました。 リストと言ってもね、こういう消し方ですね。 ここではね。 これでも大丈夫か。こういうオンチェンジがあるって感じですかね。 撮ってみますかね。オンチェンジ。 で、エスティングポイントのクロージャーですね。 ちょっとね、変えますね。これでいいや。 フィルターが変わったら、リストを更新してあげるよっていう風になって、 アニメーションはこうやって、ランドマークのラプトバリューを与えとしてね。 デフォルトでしょ。これは良いですね。で、オンチェンジを渡ったときに、 このFixMeが今達成したので、削除可能。 で、バインディングいらなかったですね。なので、このバインディングを消していくわけですけど、 一番内側から消すと楽ですね。 これを消して、戻って、ランドマークIDのパラメータが無くなったので消して、 それでここで渡すべきランドマークIDのバインディング。 これも消して、それでここもね、クリックしてランドマークIDを消す。 でもこうやって何気なくね、もういらなくなったコードがあるなーって言って、 ザクザク消してましたけど、 慣れてないと、これ無くなって、いらなくなったっていうのが、 頭から飛んでることとか普通によくあるはずなんで、 これはどう対処するといいんでしょうね。 残ってるとやっぱり、このコード何なんだろうってね、 あとは誰かが読まざるを得ない状況になるんで、 負担がかかるんで、やっぱりできれば消したいわけですよね。 でも、覚えているのが難しいというのがあると思うんですよ。 自分も覚えるの苦手なはずなんですけど、 なんかここでもですね、いらないという前提で、 たぶん覚えてるというか一連の流れでやってるんだと思うんですよね。 いらなくなったからこっちのコードをこう変えて、こう変えて、 その一連の流れでいらなくなったのを最後消すっていうね。 こんな感じでやってるのかな。 忘れるときはもちろんあると思うんですけど、 そんなのでね、なかなか難しいことをやってるっぽいので、 この辺を消す予定のものがあったら、 最近の自分も含めてですけど、あんまりメモを取らないじゃないですか。 網にわざわざ。 だけど、これでここでね、今やってることに対して、 後でいらなくなるっていうのをちょっとメモしておくとかね。 でも、カビちゃんのテーマがここで、 いらなくなる予定の変更をこれから色々かけていくときに、 ずっといらなくなったら消すみたいなね。 これとでは最後当たらないと、また見逃すわけですけど、 見逃す可能性があったり、他の人に当たったりするようなときは、 なぜいらなくなるかまたバカになりますけどね。 そういったところをちゃんと書いた上で、 こっちのメモのほうが今のときはいいのかもしれないですね。 網に書いたら自分だけなんでね。 とにかくそのいらなくなる予定のものをちゃんとメモしておく。 こういったメモの下があるし、Xコードの場合、 行でブレイクポイントじゃないや。 右クリックにあったのかな。 出てこないな。ここか。どこでもいいな。 右クリックでここでブックマークできますよね。 ブックマークどこだろう。 ブックマーク。これでブックマークして、 他のブックマークにこれを押すとメモ書けるんで、 ここで今のリファクタリングが終わったら、 いらなくなるみたいなね。 今っていうのもちょっと表現悪いですけど、 こういうふうに書いておくとメモになって、 このメモはこっちのブックマークのナビゲーターですね。 これで見ることができるんで、 クセ掛けつけばメモ最後。 メモをいろいろしまくって、コードを書いていって、 コードが一段落したらメモを見るっていうね。 クセをつけてこのメモがなくなるのを目標にする。 そんな風にすればいいかもしれないですね。 じゃあそんな感じでやっていくと。 メモをどう消すんだ。 押してここで消すのか。 テックできてもしょうがない。 チェックするとテックが入ってて、 メニューの、あ、テックが入るんだ。 なるほどね。 テック入れてて、最後消せばいいのか。 これはもう完全にこの辺いらないよみたいな風になったら、 これをバシッと消せばいいんだ。 こんな風に使っていけばいいのかな。 とりあえずリストメニューが。 今のメモ間違って終わったので、バインディングを消すですね。 ランドマップリストはIDのバインディングを消す。 リストメニューは残したく。終わって終わりですよね。 それでOK。できましたね。いいですね。 これでリストが見やすくなって、オンテンジとアニメーションと、 こっちOSならリストメニューで、フレーム、これフレーム。 フレーム別に順番違っても大丈夫ですね。 だったらこんなへんのとこやんないで、こっちで。 良いですね。こっちOSだったらこれ。で、iOSまたMacOSだったらこれ。で、終わり。 プラスプラットフォームの都合ね、どうしても見にくくなっていっちゃうけれど、 これはしょうがないですかね。 またね、この辺が混雑して困るような場合は、なんかモディファイヤーを工夫するという手もあるけど、 工夫しすぎても、これ名前でいい感じにまとめ分けるってことは難しそうな雰囲気を感じるんで、 まあこうやって書いておいたほうが良いかもしれないですね。 この辺何ていうモディファイヤーにするかって言ったら相当難しいと思うんですよ。 プールバーが2つあってタイトルが、ナビゲーションタイトルが、で、それがiOSとMacOS専用のものと言われてもね、 さて、それは何なのって言ったら、OS固有のものっていう感じでね。 これをね、iOSとMacOS専用のモディファイヤーとかそういった感じの名前にしちゃうとね、 だから何て感じになっちゃって、その後のコードの書き方が難しくなってくる、そんな気がするんでこれで良いでしょう。 ディテールはスレッチでランドマークIDに対して、えーと、フラットマークで、この辺ちょっとでもなんかややこしいですね。 ランドマーク、えーと、フラットマークでランドマークbyIDだから、セレクティブランドマークですね、これね。 つまりね、ランドマークbyIDはアピーリングか、だからこれを丸と、こういったのね、何書いてあるんだろうって分かりにくい時は、 数字に切り出すとすごく分かりやすくなりますね。 つまり何かって言ったら、ここがいいかな、えーと、セレクティブランドマーク、あれ、セレクティブランドマークあるじゃん、えーと、ありますね、いいですね。 セレクティブランドマークさっき言ってたやつちょっとコメントで入りますけど、セレクティブランドマークIDが値があった場合は、フラットマークでランドマークbyIDで返すですよね。 つまり、セレクティブランドマークIDがあったときは、ランドマークbyIDをこれを返す。 そうでなければニル、なのでコードピッタリですね。 セラティブランドマークでランドマーク、エ レメントbyIDではこれもコピーして使える可能性があるので、 セレクティブランドマークでランドマーク、エレメント帯ID、ここが、ここまでをコピーして、これでさっきのセレクティブランドマークを見ましょうか。 セレクティブランドマーク、ライトリングランドマークでランドマークbyIDで、ランドマークbyIDがモデルデータになっていますよね。 そした上、先程のことがありますが、セレクティブランドマークIDがなければフラットマークだからニルですね。 これは、セレクティブランドマークのIDがあった場合には、モデルデータのランドマークのエレメントbyIDですよね。 これが、こっちはランドマークbyIDなんですけどランドマークはモデルデータの、あ、ランドマークですか、 bindingランダマークって言 dish、bindingランドマークでそれがIDと、こっちはランドマークだから、 これ自体は、モデルデータのランドマークはランドマークですね。 ランドマークだけど、これBINDINGですよね。 全体をbindingした、bindingランドマークですね、全体をbindingしたもの。 エレメントbyID、エレメントbyIDっていうのは、フィルターで取ったもので、 こっちのランドマークbyIDのよう、bindingランドマークのパブスクリプト、 パブスクリプトって出てきたとこも難しいですよね。 辿れるのかな、このカッコの辺り、あ、ここなら辿れるか、あ、でもここに来ちゃった。 えーと、ここじゃないですね、あ、IDに来ちゃったな、これやっぱり辿りにくいってことですかね、このカッコで押すの、あ、ダメか。 うん、びんリングのアンドマークスで ランドマークスの中で、bindingランドマーク ですね、シーケンスのランドマークでもない bindingランドマークでですね、これのサブスクリプトが ない。なにサブスクリプトどうやって出てきたんだろう。 シーケンスのエレメント、シーケンスのランドマーク でもない。あれこれ買う。 identifiableなシーケンスで動作にいるのは ランドマークのエレメントbyID。 ランドマークでサブスクリプトでエレメントbyIDだかな。 やはり、自信はないんですけど、ここですよね。 focusedvalueでselectedランドマークですね。 selectedランドマークは自分のですね。 自分のっていうのはランドマークリストのこれですよね。 focusedvalue、focusedvalueってどういう関数でしたっけね。 focusedvalueはkeypass、writablekeypassに対して valueか、あとか、selectedランドマークにランドマークIDのランドマークを入れていくのか、あとか。 でもselectedランドマークにランドマークIDだから入れていく、これがなんか違うのかな。 focusedvalueか、あ、これだ。 これだからいいんだ。なので、これもsiosでfocusedvalueで focusedvalueではリストですね。リストのfocusedvalueでそれに対してお気に入りを操作するんだ。 これmacOSにして動作テストをしてますけど、macOSにした上で ここのコードをselectedランドマークに対してselectedランドマークという風にしてあげる。 これでビルドをかけて、ビルドが通るので実行して これで選択したランドマークのお気に入りを操作できれば このコードで機械通りに合ってるというね、そういった風になる。 こうやってセントマリーウェイクを選んで、このお気に入りを押すと 入れますね、セントマリーウェイクのね、ちゃんとね。 入りますよね、消す。 で、消す。 で、マクドナルドも動きますね。 大丈夫ですね。 はい、で、そんな感じで、よかった。 なんかうっかりしてましたね。 あれだ、うまくできたと。 で、あとは音アプリ、あと音チェンジ。 音アプリあと音チェンジってこの辺、統一感ある。 あと統一感というか、OSに限らなくてどこに置いても良いから 上にしようかと思ったけどここだけか。 ここ、あれ、なんか思ったことなかったっけ。 あれは、あれ、まあいいか。 だっけ、忘れてた。 ここ、じゃあいいや。 という感じで、OKですね、これでね。 まあでも上の方に持っていきますかね。 あとここか。 ここだけか。 まあいいや、これでね。 OS、あとここだ。 条件が広がったの。 外側ですね。 あの辺ほんとかさばっちゃってね。 シャープFは結構見にくいんでね。 何とかしたいんですけど。 まあ、良くないかなって感じですね。 うん。 これがまあ、なんかモディファイア作っておいて、 なんだろ、ここで、ちょっと。 ディペンディングでオン。 .macOS、iOSで、この中でディペンディングオンで。 あ、でもそうやって、なんかややこしいですね。 これで、なんかビューとかもらってもね。 これで素直にやった方が良いですね。 まあちょっと面倒なぐらいだからね。 独自ルール作るよりは面倒さんにしたかった方が全ての人にとっては、 多くの全ての人たちにとってはね、分かりやすいんでね。 あとこのオンチェンジは完全にデバッグ用ですね。 なのでこのデバッグメッセージの前からこんなの消して、これで良いですね。 もう出来ましたね。 これでランドマークリストがストリームになって良いですね。 もう1個だけ見ておきましょう。というのもランドマークローですね。 これを見て、何度も言ってるやつですね。 プライベートセットが言語仕様で良いのではないか説をまだ覆していないのでこれで良い。 それで、HStack、ランドマークロー、この辺のプレビューはプレビューありますね。 これは何だっけ、OSは全部か。なのでこれでプレビュー。 だけどmacOSのね、プレビュー出しにくいんでiOSにしました。 これでプレビューを出しとくとして、ちょっとやってみていきましょう。 そうした時に、マインディングが良いとして、HStackでイメージがあって、 これはランドマークローだからイメージがあって、それでVStackが、VStackでテキストとアネームとパークね。 アネームとパーク、またちょっといつもと違う感じですね。で、IsFavoriteはスペーサーを置いて、IsFavorite。 イメージとコンテンツみたいな感じになるんですかね。 という風にすると、例えば、HStackでイメージエリアとしてここのイメージを持っていって、 何、プライベートエクステンションでランドマークローで、で、バー、何だっけ、イメージエリア。 で、サムビューって忘れたけど、これでアトビュービルダーにして、さっきコピーしたやつを貼ってあげると。 これでまずイメージエリアOKでしたね。 その後がコンテンツエリアですかね。なのでコンテンツエリアとして、 このコンテンツエリアをここまでスペーサーも組んでガッツリと持っていくか、 これ崩れないかな、大丈夫かな、ちょっとプレビュー見てからにしますかね。 コンテンツエリアを使いながらコンテンツエリアを書いちゃったから、コンテンツエリアをいっぱいコメントアウトして、 これでプレビューを出して、まずスペーサーがよしなに動かないような予感がするんですよね、なんかね。 わかんないけど、動くのかな。 この予感が当たってたらほんのちょっとUIの感覚が養われてきたのかな、みたいなセットポイントを感じるところ。 とりあえずこうやってプレビューが出て、下のほうかな、ロールができない。 これでタイトル系とスペース空けて、ここが崩れる可能性がもしかするとあるコンテンツエリアにこれを持っていっただけね。 そうしたときにコンテンツエリアをこの部分に定義してあげて、ビュービルダー。 ではコンテンツエリア、で、サムドビューとして、こうですね。 そうしたときにプレビューが崩れるかどうか。
