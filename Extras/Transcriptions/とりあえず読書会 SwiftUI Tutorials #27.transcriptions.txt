Transcription & Summarize : とりあえず読書会 SwiftUI Tutorials #27

はい、ではとりあえずどっちかに始めていきましょう。 SwiftUIとTutorialはね、読んできてますが、だいぶApple Watchのアプリもね、進んできて、 まあ進んできてていうと、まあそんなに大きく大きい感じのね、アプリではないですけど、 まあそれをやっていて、リファクタリングをしながらでね、前回かその前か、 その辺りで、なかなかリファクタリングに手こずってしまった感じがあって、 元のTutorialとはちょっとずいぶんね、データの渡し方っていうのが変わってきちゃったんですけど、 まあでもね、なんか、どうなんですかね、エンバイロメント、 SwiftUIのエンバイロメントってどこまで活用するといいんでしょうね、 便利なのは確かだと思うんですけど、うーん、悩むしところかなと感じるのが、 特に今回のスタンプルみたいに、インデックスをアクセスするみたいなね、 そういったようなときにインデックスをアクセスするんだけど、 すでにインデックスで取ったアイテム、これをまたエンバイロメントから探すっていうのをね、 やっていて、まあ、いいんですけどね、それでもね、 ただ、なんか、渡ってきたものをまた別の場所から探すっていうのが、 なんとなくね、違和感を覚えるところで、 こんな不確かさを持ってきていいのかなという、そんな観点でね、 あと、リファクタリングをして、今のところは、バインドしたものを渡すっていう形を取ることによって、 最終的にはね、エンバイロメントからインデックスを探すみたいなことはしないで済んでいる、 という形で取ってますけど、 まあ、そういったSwiftUIのコードを見たことがないので、 まあ、それが正しいのかどうかね、分かんないんですが、 まあ、でもその方針で、論理的には間違ってなさそうな感じがするんで、 こんな調子で、引き続き、SwiftUIのチュートリアルをね、 この方法でやって進めていくっていうことをしようと思いますが、 リファクタリングした後のコードどうしましょうね、 アップロード、アップデートが終わってからアップロードするっていうのも、 何なのかもしれないですね。 まあ、いいか。とりあえずそんなところを気にしながらやってみました。 まあ、何しても今日はセクション4を見ていく感じになりますね。 さっそく読んでいきますか。 トランドマークリストをツイッターする、 トランドマークリスト、iOS4に作ったものが、 ウォッチOSアプリでも担当国よって言ってますね。 で、それが自動的にナビゲートする、 ウォッチ、アップロード、 特定の、ああ、こういうのか、 自動的にナビゲートする。 まあ、これは同じプラスメダからですよね。 で、クリティブ、 ウォッチOSにコンパイルする。 これは別に作ったんですけど、 で、次にコネクトリスト、 リストをウォッチのコンテンツビューに連結する。 そうですね、これがないとね、 もはや表示されてないですからね、 もはやダメ、まだ表示されてないですからね。 で、それによって、 プレベルのビューが動くようになるようっていうね、 こんな感じですね。 はい、じゃあ行きましょう。 ステップ1として、 コレクションビューを選択する、 コンテンツビューを選択する、 さっそく連結するのか。 で、ウォッチランドマークアップのフォルダーからですよね。 で、それで、ランドマークディテールのように、 コンテンツビュー、ウォッチOS、ターゲット、 えーと、SAME NAME、 えーと、ランドマークディテール、 同様ですよね。 コンテンツビュー、 これ、ウォッチOS用のコンテンツビュー、 コンテンツビューファイルは、 これ、ウォッチのアプリを、 アプリを作った時に自動的に作られたものがありますね。 それを使っていったんだ。 で、同じ名前で用意されていて、 名前を維持しておいて、 インターフェイスは、 簡単にファイル、 いや、ファイル、 ターゲット間で、 簡単に共有できるように、 名前とインターフェイスは同じにしておく、 って言ってるけど、 これは自分で作るんですよね。 これはコンテンツビューですよね。 で、コンテンツビューで、 ここで何かやったのかな? やってないですよね。 コンテンツビューがあるだけですね。 で、それで、 ウォッチOSアップのルートビューは、 コンテンツビューを、 リストビューを表示するように変更しましょうと。 えーと、モデルデータ、 エンバイロメント、 えーと、モデルデータ、 えーと、提供する、 EC2ってなんだ? えーと、 必ず、提供するモデルデータをエンバイロメントとして プレビューに提供する、ランダムアプリストが使うからですかね。 で、そうそうそう、こうやってね、 エンバイロメントを忘れるとアプリが落ちるじゃないですか。 アプリを落とすのが嫌いだった時に、 エンバイロメントを使いまくるっていうのが、 ちょっと気になるんですよね。 で、よく、どこかにエンバイロメントを追加したために、 どこかのプレビューからアドルっていくと、 エラーで落ちる、プレビューができない、 みたいな行動をよく見たりするんでね。 意外と難しいと思うんですよね、コンパイラーで判断できないんでね。 だから、UIキットとか入れてる感覚と、 そういうUIをエンバイロメント使って入れてる感覚が、 そんなに変わんない気がするんで、 まだ宣言できるかどうかっていうのがありますよ。 なので、その辺が違和感を、よく呼ばれる行動を見ていってるんですかね。 はい、えーと、とにかく、ランダムアプリは既に提供している、 ランタイムのアプリケーションレベルで提供している、 と言っていると、よくわからなかったけど、まぁそういう感じね。 で、iOSでもやったような感じで、私、それを エニプレビュー必要に応じて、必要な場所に提供している、 なんて訳してもらえますか。 で、当時のプレビューレベルで既にこれを提供しているが、 どのプレビューについても提供する必要がある。 ランドマークリスト、ここでいいのかな。 ランドマークリストのエンドビューに対して持てるデータを渡す。 ここまでやるか、まだいいか。 ライブプレビューでアプリの動作を確かめるよ、というお話らしい。 ここまでやったらいい感じですね。 アップルウォッチのコンテンツのビューですね。 この中でランドマークディテールを提供してあげる。 ランドマークディテール、そしてランドマークリストですね。 ランドマークリストを提供してあげて、 プロファイルのバインディングが要らないのかな。 で、それで、ショーイングバインディングプロファイル。 プロファイルが自分で作ったんだっけかな、このバインディング。 用意するプロファイル。 自分でショーイングプロファイル、自分で作ったんだよね。 エンバイロンメントとしてモデルデータを作ったんでしょう。 ここにプロパティを渡さなきゃいけなくて、 このランドマークリスト、iOSのほうも見ておきました。 エンバイロメントを渡した感じかな。 コンテンツのビューの中で、 ショーイングプロファイル。 ランドマークリストでショーイングプロファイルを渡しておいて、 ショーイングプロファイル。 ショーイングプロファイルを自分は勝手に、 ランドマークリストの両方でできるようにしようという話をしたんだ。 それをやるためにこうなっていて、 ショーイングプロファイルを渡してあげる必要があるけど、 これはウォッチOSで使わない選定だから入れてなかったのか。 ショーイングプロファイル機能をウォッチOSに入れるという方法が一つ。 あともう一つは、ウォッチOSではショーイングプロファイル機能は持たせないという方法も一つありますね。 ランドマークリスト、ショーイングプロファイル。 ランドマークリストでショーイングプロファイルに寄せするか、 ショーイングプロファイルを表示するかどうかのボタンを追加してあげるということをするのかな。 そうですね。 で、それに応じてショーイングプロファイルのバインディングが変わることで、 自動的にね、 要はだから、iOS版のコンテンツビューですかね。 iOS版のコンテンツビューには、親にね、ちゃんとショーイングプロファイルがあるので、 これを使ってね、 ショーイングプロファイルを表示するという方法ですね。 これがどうか、アップルウォッチだと言わないのか。 さて、どうしますかね。 アップルウォッチからは削ってあげるという形を取るのが一番いいと思うんだけど、 まずはチュートリアルに進んでいってみますか。 なので、僕はちょっとバインディングをフォルスのまま渡してあげて、 絶対に機能しない状況としてまずは作ってあげる。 なので、ここでショーイングプロファイルはコンスタントでフォルス。 こんな感じでね、また誤魔化す。 はい、これで試せるようになったというお話だと思うんで、 そしたらコンテンツビューのプレビューを見ればいいのかな。 こんな感じでやっていきますね。 これでちゃんとリスト出ますかね。 出ると思うんですが、あとはお楽しみという感じですね。 これで出てくれて動かしてみたら次のステップに入っていって、 その後、ゆっくりとショーイングプロファイル、 アップルウォッチでは使わないプロファイルのカスタマイズをどうするかを、 どういうふうに折り合いをつけていくかというのを考えていったらいい気がしますね。 折り合いをつけていきますね。難しいですね。 プロファイルをウォッチで見れた方がいいという発想が十分に考えられるので、 そうした場合には、このショーイングプロファイルは悪くないと思うんですけど、 そうしたときにこのショーイングプロファイルのボタンが、 アップルウォッチでどういうふうに表示されているか、 それによって、うまく連絡が取っていけるようだったら、 プロファイルを見せるというのも、 やはりうまいよな、というとリアルな方針に従いますかね。 だからアップルウォッチを全体、ひとまず作ってみて、 この状況において、プロファイル表示がいるのか、いらないのか、 みたいなふうにすれば、まずはいいのかもしれないですね。 でも、そんな感じにするとして、プレビューがまだ進まないんですが、 ビルドを一回してみようかな。 ビルドを一回やって、ちゃんとビルドが通ることを確認しましたので、 プレビューを毎回表示して、これでちゃんと出てくるかどうか、見ておきましょう。 読み進めたらいいのかな、プレビュー出てこないんだったらね。 アップルウォッチの、これでアップルウォッチ出力11でしょ。 で、問題なくビルドできてるもんね。 問題だったらこれでちゃんと表示されると思うんですが、 まあ、されないのかな。 まあ、いいか。 まずは確かめたつもりで、次行きましょう。 確かめられれば、こういうふうに、エイバリッツオンリーとか、 いろいろこうやってリストとかが出るようになるよと。 で、セクション5か。 まあ、行ってみましょう。 まずは、Notification Interface、これを作る。 ランドマーク、ウォッチOSバージョンのランドマークアプリ。 これでは、あ、これはほとんど完成したんだって。 あ、そうなのか。 で、最後のセクションとして、Notification Interfaceって何だ? ランドマークの情報を、Receive Notification Indicatingsというプログラム。 1、UofMapLocation。 お気に入りの、ロケーションの1つを、 閉じる、閉じる、のを示す? NotificationをReceiveする? なかなか出てわからなかったな。 えーと、よく間違ってるのかな。 ちょっと、よくしてもらおうかな。 えーと、何だろう。 最初のセクションでは、お気に入りの場所の近くにいることを示す。 全然違う役だな。 お気に入りの場所の近くにいることを示すと、通知を受信した際に、 あー、そんな受信、Notificationという気がしますね。 ランドマーク情報を表示するうち、インターフェースを作成する。 全然よく違った。 最後では、Receive Notification Interface、表示するランドマークインフォーメーション。 ReceiveしたNotificationインディケイティング。 あー、クローズ2って近くって意味か。 あー、そっかそっか。 これ、なんか難しいね。クローズ。 まあ、有名どころの単語だからね。 大丈夫な人多いと思うけど。 うん。なるほど。 とにかく、近づいたときのNotificationに応じて、 それをアップしたりして表示するようにしようって感じですね。 このセクションでは、カバー、ディスプレイ、Notification、Receiveした後の、 Notificationをね、Receiveした後のディスプレイだけ。 どうディスプレイを表示するかだけに、フォーカスしていくみたいね。 で、Notificationの送信に関する辺り、この辺りは触れないということらしい。 はい、じゃあそんな感じで、ランドマークインデックスがあって、 データがあって、こうなっていてですね。 で、それですね。行っていく前に、ちょっとプレビューを動かしてみますか。 動いてないな。どうしようかな。 いっぱいプレビューを埋めるってわけにもね、いかないですよね。 これで、保存し直してみましたが。 保存するんじゃないや。 埋めるってわけにもいくか。 ビルドしてみた。ビルド成功してみた。 あとは、ここでランチウォッチにしてみますかね。 これで再びプレビューを出してみて、これで動くかの。 動くところまで確かめたいですね。 ずいぶん大きなセクション移動になっているので、やることがね。 これが動かないってのはどういうことなんだろう。 ネットスコートを一回落とせば直るとかいう、 そういったよくあるお話ですかね。 どうしようかな。どういう手もある。 またはクリーンビルドという手もありそうね。 ネットスコートを一回落としてみますか。 これでプレビューをもう一回動かしてみますが。 プレビューがウォッチOSのビルドが走りましたね。 今までと動きが違うから、いける気がしますね。 準備中。iPhoneシミュレーター。シミュレーターのブーティング。 iPhoneになっている。これじゃダメですね。 ランドマーク4をウォッチOSに変えて、それでシミュレーターをウォッチOSでね。 やっていくよっていうところですよね。 それでラジオウォッチに変えて、それでどうしようか。 やっぱりビルドを止めて、それでビルドがちゃんと走ってからね。 またキャンバスを開いてみようか。 こんな感じでやっていきますか。 これでビルドを守って、プリペアでiPhoneシミュレーターをプリペアしてますね。 まあいいか。評価をさせたらいいんだけれどもねって感じですね。 こうやってうまくいかないときにはどうしたらいいんでしょうね。 クリーンビルドがない。やっぱりiPhoneシミュレーターをブーティングしてるってことは、もうちょっと待てばね、いける可能性もあるし。 あともう一個はエミュレーターを再起動と思ったけど、シミュレーターはそもそも動いてないか。 手裏側で動いたのかな。ビルドが成功した。 こんなのは特にないかな。 試せないですね。どうしようかな。実行しちゃった方がいいかな。 実行しますか。 実行しましょう。 これでエミュレーターが動くはずなので、エミュレーターが動いたらApple Watchが出てくる感じかな。 どうですかね。 出てきた。 これでちょっと懐かしいことを思い出しましたけど、Apple Watchのアプリを初めて作ったときに、このシミュレーターを見たときに感動しましたね。 そのときまだApple Watch発売前だったんですよね。 そういったのの使われるイベントがあって、それで作ってみて。 8キーの発売前ね。懐かしいですね。まあそれはいいや。とにかくこれは動きそうですね。 エミュレーターなら大丈夫な気がする。 これでリストが表示されて、遊び終わってから次へ行きたいんでね。 プロファイルのボタンがこんなところにある。 これは表示しないようにしたいですね。 またはプロファイルを押すと、プロファイルが出るようにする手もありますけど、ちょっと狭いしね。 これセントマリベックを押すと、これは開きますね。 アプリ自体は良いですね。 さっきのボタンがちょっと微妙だから、これを消したい気がするのと、まずはちょっとリアルな作品にやりましょう。 あと表示が違うのが気になってるけど、ランドマックスのところ。 プレビューじゃないや。 なんとなっても、ボタンが邪魔なだけだ。 まずセクション5行ってみましょう。 ノーティフィケーションによって表示されてきたランドマックスを表示するというお話ですね。 そのためには、ランドマックスインデックスをデータから取って表示するという形で、インデックスが回ってきそうな気がしますが、まあいいか。 とりあえず、新しいカスタムビュー、ウォッチランドマックス、そういったウォッチOS用のアプリの中に、ノーティフィケーションビューという形で作って、 ランドマックスに関する情報をそこに表示させていくと、ランドマックスとタイトルとメッセージ。 コードはこれですね。ノーティフィケーションビューで、これはコピーしちゃったほうがいい感じしますね。 どこまでコピーしようかな。ビューの中身、あれですね。 これでノーティフィケーションビューをまず作ってあげると。 なので、これはランドマックスをウォッチOSのところで、Zoom with UIビューを作って、 ノーティフィケーションビューをこんな感じで作り、そしてプレビューはどうしようかな。プレビューは動かしたほうがいいか。 それで、中身、これに今コピーしてきたやつを貼り付けてあげると。 今のところは良いですね。 これによってノーティフィケーションビューが表示されるけど、まだそれじゃないか。 この辺の引数がまだされてないですよね。 タイトルとメッセージとランドマックスがちょっと気になりますね。何表示したいんだろう。 まずとりあえずここまでコードができて、次。 プレビューを追加する。 タイトルとメッセージとランドマックスを ノーティフィケーションビューにセットして、 プレビューができるようにする。 これでノーティフィケーションビューがデータが 提供されたときにできるようになったかな。 任意のノーティフィケーションバリューを ニルにできるので、役立つキー。 デフォルトプレビュー、ノーティフィケーションビューを データがないときにも一致するのに役立つ。 ノーティフィケーションビューを作るこのコードを デフォルトプレビューにしてみましょうか。 データがないときにこれをニルにできるのはいいんですけど、 役立つのかな? 自分の感覚とは違う気がするんだけど、 やってみないとわからない。 とりあえず、ナトルロックというオフを前に入れて、 箱前に離れているという話とランドマックのゼロ。 これのプレビューはダメですね。 まだデータが違うはずですね。 あとここは自分のコードのリファクタリングの都合で ダメになっている部分ですね。 これはリサイザブルがダメなだけで、 リサイザブルは確かアクリメイジの中にも持たせましたよね。 こんな気がする。アクリメイジの中にリサイザブル持たせて うまくいったんでこれでいいですね。 これでプレビューが出てくるよというお話ですけど、 全部がニルだったときには反応ランドマックで 5分でたどり着くよとか言われても、 これいい加減のこと言ってるじゃないですか。 ニルだったときに全然5分とは限らない可能性がある。 その状況でニルを許す意味っていうのが 自分にはよくまだわかっていない。 この辺も後で調整していきましょうかね。 プレビューはちゃんとできたと言っても 言っただけなんでこんなもんでしょう。 これでステップ3として新しいスウィフトファイル、 ノーティフィケーションコントローラーを作って、 コスティングコントローラー構造体、ランドマックスタイトルと メッセージプロパティを持つ構造体。 ここで情報が渡ってくるからそれを表示したいという意味か。 こんな感じがしますがコントローラーなのかこれは。 コスティングコントローラー。 まあいいか。これらのプロパティは値を保存する。 ノーティフィケーションコントローラー。 ノーティフィケーションコントローラーとか WKユーザーノーティフィケーションコントローラーを検証する形で作っていくのか。 これ使ったことないなユーザーノーティフィケーションコントローラー。 全然アプリ作ってなかったからですかね。 ノーティフィケーションビューが渡ってくる。 違うか渡ってくるわけじゃないか。 あ、これ表示するやつね。 あ、なるほど。わかった。 それでデータがなくても大丈夫ってのを考えたのかな。 とりあえず作っていきましょう。 新しいスウィフトファイルでノーティフィケーションコントローラーというのを作り、 この中に今コピーしてきたやつを貼るけどインポートが抜けてますね。 ユーザーノーティフィケーションコントローラー。 ノーティフィケーションコントローラーってなんだ。 OSのやつ? これも初めて見た気がするけど、OSかな。 これでとりあえず今入らないでしょ。 これはなくなったところで大丈夫でしょ。 大丈夫だよね。一応切り替えてみますけど。 大丈夫だよね。 そういう人にはもういろんな。 これはいるか。 こんな感じでユーザーノーティフィケーション数に対してランドマークとタイトルとメッセージ。 これがオプショナルな形で持ってて、 それでノーティフィケーションビュー。 ノーティフィケーションビューはオプショナルのオプションを持ってますけど、 今渡せないのね。これからかな。 まずは先に行っておきますか。 これでアップデートボディメソッドとプロパティ。 これらのプロパティを使って、 そうですね。タイトル、メッセージ、ランドマーク。 これらを今からセットするよという形になると。 ここで思うのはノーティフィケーションビューに何も渡さないというのは普通考えにくいですよね。 塗りくら塗りをしてるからって別に、 企画用だよって言いたいわけではない気がするんで、 これはイニシャライザー搭載しておいた上で、 規定値なんか持たせない方がいいんじゃないかなっていう気がする。 なんか人のコード見てると、 規定値を持たせたがる人とか言ったりするんですけどね。 規定値はあくまでもね、 常識的に、 それがその値であることが多いでしょうみたいな、 そういった場面でなければ付けない方がいいですよ。 何渡してるかわからないんでね。 これだとノーティフィケーションビューがそのまま使えるかと思ったじゃないですか。 でも基本的には情報が欲しいわけですよ。 見るだろうとなんだろうと。 こうしてイニシャライザー、 ディフォルトの比率を渡さなければね、 ここで指定してあげざるを得ない。 ってことは指定し忘れないっていうね、 そういったメリットがあったりするんでね。 そういった手を取った方がいい気がしますね。 これでできた。 ついでにここファイナルクラスですね。 提唱するつもりはないんでね。 あとはこれ表示するだけで中身書き換えないんで、 レッドでいいんじゃないかなっていう気がする。 あ、でもわからないか。 ノーティフィケーションコントローラーがどう使われるのかを自分が知らない。 まずバレたっていっときましょう。 それで定義するランドマークインデックスキーを定義する。 このキーを、 レッドオンなどの ノーティフィケーションからランドマークインデックスキーを ノーティフィケーションからランドマークインデックスキーを 展開するのに使うよってことらしい。 ノーティフィケーションコントローラーに対して レッドオンなどの レッドに指定するのが まずこれだけか。 ランドマークインデックスキー。 後で多分直すことになる気がする。 とりあえずここに持たせるというお話ですね。 そうした上で次。 ディクレシーブ。 このメソッドをノーティフィケーションから データをパースするために作るのかな。 このメソッドは コンパイラーのプロパティを更新する。 このメソッドが呼ばれた後 システムは無効化する。 コントローラーのプロパティを無効化して ノーティフィケーションを更新する。 システムはそれから ノーティフィケーションをアップルウォッチ上に表示すると。 ディクレシーブ。 これを付けてあげればいいということですよね。 で、オーバーライトだから やっぱ機械クラスにちゃんとあるってことですね。 これはね。 これを載せてあげますが 改良の違いがいっぱいありそうなコードを 貼っている気がする。 オーバーライトとにかく まずは貼っておきましょう。 コードを理解するのをやらないといけないですね。 いくら貼ると言っても やられたものをね。 モデルデータを取って これも変ですかね。 これは。 リトルをシーン。 ユーアップアソシティブのノーティフィケーションのカテゴリーと 関連付けられた ユーアアプリケーションのシーンで リクを見つける。 と、やってみようか。 通知を受信すると 通知のカテゴリーに関連付けられた アプリ内のシーンを検索する。 で、上げて ランドマークアプリに戻って ノーティフィケーションシーンというのを ランドマークユーアカテゴリー上げて 上げて これは この 無限の 無限の 無限の 無限の ノーティフィケーションシーンを 買うよんかな。 こんな感じにカテゴリーを使って ノーティフィケーションシーンを 追加してあげる感じ。 で、シーンはWatchOS用だけで コンディショナルコンパイレーション。 WatchOSの時だけで これを使うよっていうことを やっていくのか。 この経由はどうするんだろうね。 ランドマークアプリ。 これをOSで分けるのは 全然アリだと思うんですが。 ノーティフィケーションシーンを 登録をするんですよね。 まあ一応書いてみますか、これ。 ランドマークアプリ。 これ今日通過したんでね。 このチャートイフで表現すべきか、 工夫すべきかっていうのは 難しい差事加減ですかね。 どっちでもいいと言えるぐらいの程度ですが、 このランドマークアプリ。 これを今日通過したがために こういった条件が必要ですよっていうね。 そういったお話ですよね。 で、それでWKノーティフィケーションシーンは コントローラーとしてこのノーティフィケーションコントローラーを 持ちカテゴリーとしてランドマークにはあっていうね。 そういった情報を持たせる。 で、これでアプリケーション。 アラート表示する前にコンミッション。 コンテントビューへ行き、リクエストオーサライゼーション、 ノーティフィケーションセンターからの通知を有効にするというのをしないといけない。 リクエストを移動キットタスクのモディファイア。 で、コンテントビューが最初に現れた時に呼び出されるタスク。 ここでやるってことですね。 なのでコンテントビューにユーザーノーティフィケーションズをインポートして、 それでタスクの中でこのノーティフィケーションのリクエストオーサライゼーションをやっていくと。 やっておきましょう。 ユーザーノーティフィケーションをアプローチ用のコンテントビュー。 この中でランドマークリストに対してタスクを呼び出して、 それでインポートですね。 WKだけノーティフィキュアは忘れたか。 ユーザーノーティフィケーションズは全然違った。 ユーザーノーティフィケーションズ、こんな感じでOKですかね。 これランドマークリストのところですよね。OKですね。 これで取れるようになったよっていう状況で、 まずは次行っちゃいますか。 とりあえず言われるままにやってますけど。 コンテンツビューはチェストプレイグラウンド。 プレイロードが間違えた。 チェストプレイロード。ランドマークにあたってボディを使って、 プレイロードが間違えた。 通知用の情報みたいなやつ。 プレイロード。ボディみたいなやつ。 それを対するノーティフィケーションコントローラーに渡してあげる。 そのためにノーティフィケーションシミュレーションファイルというものをJOSアプリの中に作ってあげる。 プッシュノーティフィケーションペイロードという名前で付けてあげるよと。 付けてあげるよと。 プッシュノーティフィケーションペイロードファイルを 全てのターゲットに追加。 どのターゲットにも追加するなと。 これはアプリの一部ではないと。 とにかくノーティフィケーションファイルというものを作ってあげて、 それでタイトル、ボディ、カテゴリ、ランドマーク、インデックスとシミュレーション、 ターゲット、バンドル、プロパティ。 これを更新して、カテゴリをランドマーク、ニアにセットして、 デリトスの他のキー、合わないキーはザクトして。 それで、負けそうなタイトルを、 シミュレーションとカットのキー。 で、ペイロードファイルはシミュレートする。 リモートノーティフィケーションから送られてきたデータをシミュレートすると。 それは、プッシュノーティフィケーションペイロードに こういうデータを作ってあげるよと。 まずは、ファイルを作るところをやっておきますか。 ノーティフィケーションペイロードは、 ノーティフィケーションの、 間違われたね。 何で作るんだっけ。 WatchOSでノーティフィケーション検索したほうが早いかな。 これを追加して、ファイル名は、 プッシュノーティフィケーションペイロードとして、 どのターゲットにも入れないとOKですね。 で、作ってできたやつに、 いろいろ情報を入れるわけだけれど、 入れるものは、アラートとして、 カテゴリーとして、この辺を入れてあげると。 まずは、ルートにコピーしておきますかね。 これで、カテゴリーとか、デザインタイトルとか、 その他は、消していいよ。 カテゴリー入れた、スレッドIDとかもいらないそうね。 これで、エミュレーターアクションズもいらないし、 カスタムキーもいらないと。 こんな感じで。 これは、JSONかな。 ちょっと戻そう一回。 一番末尾には、あんま入ってなさそうね。 JSONだと、ファイル入れると、 ちょっと厄介みたいなね。 そういったのあったりするんで。 ここ入れてるの? ここ? 無いか。 消してみよう。 入れてますね。 大丈夫だったのかな。 まだ全部見えてないか。 スレッドIDとか入ってんじゃん。 そうか、いろいろ確かに。 これ全部、ちょっとコピーしておきますかね。 とりあえずね。 こんな感じで。 それで、ピタッと貼って。 これで良さそうね。 OKですかね。 これができたら、次。 なんか、開いてある。 消すべきものとか、いろいろあるけど。 まあいいか。とりあえずこんな感じでOKで。 それで、ビルドとしては、 ジランドマックスのアプリを実行。 エミュレーターで実行して。 最初に、このアプリを実行したら、 システムが、エンドノーティフィケーションズのアミューションを求めてくるので、 アローという形にして、 許可してから、ペックスコードをアプリをトップするのに使う。 それから、プラグインして、 ノーティフィケーションペイロードファイルを、 こっち、フェイス、ここに投げてあげるのが、 こんなことができるのか。 エミュレーターは、スローラブルノーティフィケーションって、 先の情報が含まれたもの。 これを表示してくれる。 ジランドマックアップのセンターアップアイコン。 アイコンと、ノーティフィケーションビューと、ボタンと、アクション。 これで、もう終わっちゃったね。 まずやってみますか。 これで、まずシミュレーターを動かしてあげて、 まずは、権限の許可を取ってあげると。 初めての実行の時に、許可が求められるので、 これを許可すると。 これでいいですね。 許可が終わったら、アプリを閉じろって言ってましたね。 これでストップ。これでいいのかな。 そうしたら、このファイルを投げ込めって言ってたんで、 並べちゃおうかな。 これでいいのかな。 ペックスコードの横に並べてあげれば。 投げられるかな。 投げれなかった。 クッションを元に戻して、このペイロードのある場所を、 ファインダーで表示してあげて、 これで抜けるのかな。 ファイルを打って、シミュレーターを抜けてあげる。 何にも変わらないし、どうだ。 これは何でだ。 やり方間違っているのかな。 Xコードでもいいけど、 まずレトリアルをもう一回見ますかね。 もう、パーミッションを与えてから、Xコードでアプリを止めてから、 後ろのノーティフィケーションペイロードファイルを、 ウォッチのフェイスに投げ込めて、 入ってあげるように見えたけど、自分の役の問題かな。 与えたアプリを停止し、ノーティフィケーションファイルを ウォッチフェイスにトラップしてください。 その通りですね。 ハンドルができていないということですかね。 どこを見ればいいんだ。 ウォッチと共通で用意したランドマークアップ。 ここですかね。 ウォッチフェイスだったら、チームをランドマークニュアで登録して、 ノーティフィケーションコントローラー。 これがレシーブを呼んでくれそうですけどね。 ここが違うのかな。 ランドマークアップと場所が違ったかな。 コンテンツビュー。ここですよね。 コンテンツビューの中にランドマークリストがあって、 ノーティフィケーションセンターパレントで、 これは良くて、ここだ。 ランドマークアップですよね。 プリントでとりあえずレシーブしたかどうかを説明してみて、 これで今閉めれたから、 エクゼキュートアプリでオッケーですよね。 これで一回実行し直しますか。 実行し直すというのをやってなかった気がするの。 それを今やってるんで、これで移動したら、 でも落とさないといけないですよね。 まずちょっと投げてみようか。 投げてみたが何も変わっている感じがしない。 アプリをちょっと落としてみましょうか。 ストップね。 こうしたときに投げ込んでみると、何も動く気がしない。 ログが出るはずがないですね。 ログが出るはずがないからどうしようかな。 とにかくダメだったということが、 今のところ分かっているところで、 ランドマークの方の動きは凄いというね。 大丈夫ですよね。 ちょっと困ったというやつですね。 もう一回このセクションを戻って、 順々に見ていきましょう。 大体のことにそんなに触っていないから大丈夫。 そのまま追いかけられると思うんですけど。 まずは、F1。 NotificationViewというものを作りますよって話で、 NotificationViewはほぼコピピで作ったはず。 NotificationViewというものは、 僕のサプリメーターだけが、 ディファクタリングに合わせて作り直しましたけど、 これはこれでNotificationViewとしての ケースを一応見ておきますかね。 NotificationView。 NotificationViewでイニシャライザーをちょっと変えましたが、 イニシャライザーを変えたことの問題なのかな。 解決してみますね。一度ね。 それでも成り立つんでね。 これで実行して投げ込んでみて、 これは大丈夫かなと思うんですけどね。 これになって、アプリを落とさないとダメかな。 Home。Homeっていいのかな。 まあ何もとにかく変化はないですね。 で、とりあえずだとね、Xコードで落とせって言ってるから、 今みたいに落としたらいいんじゃないかと思うけど、 反応しないのはダメですね。 で、これが、これイニシャライザーのせいでは恐らくない。 で、VSparkは別にコピーしただけだからいいし、 プレビューもちゃんと出ましたしね。 なのでここは良しと考えて一応プレビュー見ときますけど、うん、大丈夫ですね。 じゃあそうすると、えーと何にハマってんだこれは。 えーと、セブンイレブンとしてプレビューをするとプレビューはした。 で、NotificationControllerスイッチを作って、 これをファイナルクラスに押しましたが、 それぐらい問題ないですよね。 UserNotificationHostingController。 この中でインポートウォッチキットを発出したっていうのぐらいが、 今のとこが気になるぐらいですかね。 で、アルポーティー書いたっけ。 NotificationView、NotificationControllerが、 あ、NotificationView書いてありますね。 やったでしょうか。 えーと、あとはインポートウォッチキット。 これ書いたかどうかでは別に左右されないと思うんですけどね。 コンパイルサイトってやってる。 それならね、移動させてXコードでオートして、 それで、UserNotificationの、えーと、フィールドをね、 これを投げてあげれば、 ここに変わらないと。 で、さらに次。 えーと、これでここまでオッケーでしょう。 NotificationViewでしょう。 次にボディに対してプロパティーを渡していく。 タイトルメッセージランドマーク。 いいですね。で、オーバーライド。いいですね。 あ、で、これまだこうなるかな。 オーバーライド。大丈夫ですね。 うん。で、次は? なんか不気味に戻っちゃうよね。なんだろうねこれね。 まあいいや。 えーと、これで次は、 どこまで行った? ここの前、まだですね。 ここもまだですね。ここもまだですね。 で、これでオーバーライドボディでここはオッケーで、 次にランドマークインデックスキーというものをデファインする。 こんな感じの可能性というのをね、考えられるのかないですが、ランドマークインデックスですね。 ランドマークインデックスというものをNotificationControllerに持たせて、 で、それで、あ、それだけか。ランドマークインデックスね。 で、これがランドマークインデックスを確かめるには、 まずペイロードの方がランドマークインデックス。 ランドマークインデックス。 これはあんまりだから関係ないのか。ランドマークインデックスね。 うん。そうね。 ここまで終わらない感じかな。 まず次か。 で、ディグレシーブメソッドを使ってデータをNotificationから取り出すと、 このメソッドはプロパティを更新するとかいろいろ言われてるけど、とにかくここでディグレシーブね。 いろいろコードがあるけれど、この辺はもう普通にコピーした感じですね。 なので、コントローラーだけ。もう一回ちょっと見ときましょうか。 NotificationController。 NotificationControllerで、この中にディグレシーブをオーバーライドで載せて、 で、それで、この先は全部コピーペーパーから問題なしと。うん。 良いですね。で、これでOK。 で、次に、レシーブ。レシーブした時に、割り当てられたNotificationのカテゴリを探す。 で、これで、リンをランドマークニアを使って追加する。 カテゴリね。NotificationSceneで、リンをカテゴリ、ランドマークニア。 いいですね。で、それで、アラートを表示する前にパワーミッションを許可する。 これやりましたよね。パワーミッションを許可ね。 これで、その前にちょっとここのコードが追加し忘れがないか。なさそうですかね。ないですね。 コンテントビューに対して、リンを足しんじゃないか。 許可ですね。ランドマークリストにタスクって、どうか。大丈夫ですね。 ああ、間違えた。これが、もう一回逆に戻れば、もっと戻ってくれるかな。 行ってくれなかったね。 はい、ではこれで仕方ない。スクロールを辿っていって、 世界一番最後まで行ってもいいのか。一番最後まで行ってから戻ってきて。 それで、レセプションまだ残ってるか。 ペイロードを作って、ペイロードを作って、それで、ここまで別に大丈夫か。 ロスコードもあるけど。 コンテントビュー。コンテントビューでタスクでしたよね。 それで、ここは良くて、ペイロード。これを追加するよという中で、ペイロードを最終的にはこんな風にする。 これを丸ごと消しておこうかな、この中にね。 それで、もう一回ロスコードの方に行って、ペイロード。 通信ノーティフィケーションペイロード。これを全部一旦発揮して、貼り付けて、これを一応投げてみますかね。エミュレーターに。 リリースに投げるとこれでいいなと思うんですが、アクセス許可。 オープンできなかったと言われましたね。 全然アリと言っていいのかなと思ったけど、投げたから間違えたとですね。 なので、もう一回、このノーティフィケーションの、APNSというやつね。 これを投げるか投げるか、何も考えないね。 コピーしたままのものを投げてもダメでしたという状況になっている中で、 もう一回一応トリアルの続き。このコードは良くて。 そうしたら、ランドマークウォッチ、ビルドアンドラン。 シミュレーター。 ランドマークウォッチアップ、ビルドアンドラン、 ウォッチOSランドマークウォッチアップスキーム、シミュレーター。 これで大丈夫ですね。それで最初に許可が求められるので、アローを押すと。 その後にパーミッションを与えたら、アプリを落として、 それからプッシュノーティフィケーションペイロードファイルを ウォッチフェイスに上げてあげる。 ですよね。これを見ておきますか。これで、そうするとこうやって続きが出るよというお話になるはずなのになっていないんだよね。 これで終わっちゃう。これは何だろう。何かを忘れている。 例えばここで、これは何だ。これはログル。あとはファイル。シミュレーターから行こうか。 シミュレーターセッティングですね。ファイルは、ニューシミュレーターとか、エディットは、これも関係ないかな。 で、テスターとか、この辺も関係なさそうですね。 で、IO。IOとして、これも関係ないね。フェッチャーとして、この辺も関係ないかな。 で、デバッグとして、ノーティフィケーション見れないのかなというのを今探しているんですけど、何か。 ノーティフィケーション。ないね。そうか。ないのか。 これを投げ込めばいいって書いてあるように自分には見えるんだけど、これが動かないね。どうしようかな。 もともと同じく見ようとすると、アプリケーションがまず共通でありますよね。 ランドマークスアップ。で、この中でOSがウォッチOSだったときには、 チェーンとしてコントローラーをランドマークにアップして登録するよと。 で、ウォッチを送るときには、後ろのノーティフィケーションペイロードのとこで、ランドマークにあったよね。 カテゴリーで送っているよ。いいですね。で、ここが違うか。 ターゲットバンドルIDが違うね。ターゲットバンドルIDは、えーと、 なんだっけな。ターゲットバンドルIDが、あれですね。 この線かな。あれ、ピーができない気がする。えーと、まあいいか。 ランドマークスのウォッチキットアップ。え、どんな名前か。この辺で、あ、そっちにも載ってるね。 えーと、こうかな。で、一回アプリを動かして、で、 バンドルIDがちょっとね、違ったら次からもう一回やるので、ラッシュ合わせがうまくいかなかったらね。 何してもひとまずこう動かして、で、動いたら、まずいきなり投げ込んでみようかな。 動いた。そしたら、ノーティフィケーションを投げてみると。変わらず。 これをいっぱいフォームこうして投げてみる。お、きたきた。お、出た出た。お、いいですね。 あ、よかった。出てくれましたね。これで完成ということになりますね、一応ね。 そうすると、いいのか。これだけ?うん。これだけですね。 では、次の問題見てみますか。ハンリーカードテック。えーと、どのオプションが、えーと、 ウォッチOSターゲットを既存のOSプロジェクトに追加するものですか。えーと、 これ選択されてるやつですね。で、これでいいんだけど、既存のデジタルディスプレイガイOSアップに OSアップを追加するよっていう、これですよね。はい。はい、正解。 じゃあ、次の問題。 えーと、なぜランドマップディテールビューを ウォッチOSでリユーズしないのか。 大きくばっかり考えてるのがですね、 サクルイメージビューが大きすぎる。 いや、サクルイメージはPure2で使ってるから違いますね。 ウォッチOSユーザーのインターフェース。 提供するオンリュー。 重要なインフォメーションだけ簡単にアクセスする。 これ、もっともっと言ってますね。 だから、リストだけを提供して、 もう1個の方のだけ。 いわゆるリストとか、AppleWatchだとカテゴリフォームだとカテゴリと、 データイメージで打ったドキッとの感じなのは 提供しないからって感じしますね。 さらに、マップビューはウォッチOSで使えない。 これは無かったですね。 共有してましたね。これでOKですね。大丈夫ですね。 ただ、大事になってくるのは要は、 AppleWatchはiOSと違って小さい画面で 画像表的なものだからね。主要なものだけ。 これだけを提供してあげることによって、 ユーザーの影響を良くしようという そういったお話でしょうね、おそらくね。 で、私は、ビューは大人のプラットフォームで 使用できる。 これは重要。ワクチンが確かめる。 ビューが表示される情報のコマンド量と、 表示するインフォメーションの方向。 プラットフォームにアカウントデータ。 そういったのを、今回のが重要って言ってる。 ちょっとすごい適当にやってしまったので、 言い忘れてましたが。 ビューを表示することは可能だが、 微妙に違った批判がね。 表示する情報の量と、表示方向と、 プラットフォームにできていることを 確認することが重要です。 だから、表示はできるんだけど、ディテールは それぞれに対して分けましたよっていうね。 こんな話ですね。 で、それで次。 次の問題は、あ、これで終わりか。 で、次はOSアプリの開発に移っていく ということみたいですが、 まずこの段階でApple Watchアプリを リファクタリングをできたりですね。 えーと、基本的には、大体ね、このドッグショップ愛は、 基本目安を勝手に1時間に置いてるから 1時間はかかってるか。 じゃあ、それはまたにしますかね。 ちょうどいい感じにしますね。 今回は、ちょっとリアルに沿って かなりザクザクとピーしていったので、 雑なところ、ザクっていうのは、まあね、 とにかくあの、 微妙なところがいっぱいありそうですね。 なので、それをリファクタリングは また次回にしましょう。 明日ぐらいですかね。 また同じくらいの時間。 8時から9時の間ぐらいからの動画から 始める感じでいくか、 ちょっとわからないですけどね。 ちょうどいい時間に始めていこうと思います。 はい、じゃあ今日はこれで終わりにしますね。 お疲れ様でした。
