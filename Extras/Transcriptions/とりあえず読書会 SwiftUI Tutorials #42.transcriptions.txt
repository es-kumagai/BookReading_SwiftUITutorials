Transcription & Summarize : とりあえず読書会 SwiftUI Tutorials #42

はい、ではとりあえずご紹介を始めていきましょう。 とりあえず読み終わったわけですが、リファクタリングをしていこうという中でね、せっかくリファクタリングするなら、いろんなことやってみたいなと、よしよし、よくなる方を一応は目指してますけど、その中でね、おなじわしで、ここでSwiftマクロを使ってみようかみたいな、そんなことをやり始めたら、なぜかコンパイルができないで終わったのが前回なので、そのあたりの原因究明ですね。 発展はとりあえず何も見つけていない状態で、ここからちょっと手当たり次第、様子を見ていこうという感じにするんで、まあ見つかってくれればね、いい感じの原因究明の仕方みたいな感じで紹介できるんでしょうけど、まあ見つからない恐れもあるんでね、そういったときにはちょっと不毛な感じの回になるかもしれないですが、まあプログラミングってね、そんなもんだったりするんで、おなじわしでやっていくことにしましょう。 ということで、さっそく見ていきますが、ここから見終わりのコードですがね、コードだと、これかSwiftシントックスか、開けてなかった、どれだこれか、これですね、ディスプレイの場所がずれてるというのは、メインとプライマリーとサブのディスプレイが逆になっているように見える、まあいいや、そんなことでもいいね、はい、こんな感じでマクロを書いていこうとしたんですが、まあダメだった、何がダメだったかというとね、フレームワークが見つかんないみたいなそんな感じですよね。 もう一回ビルドして要素を見ますが、最初はちゃんと動画を見ればよかったねというのは、まあね、今更なんですけど、これですよね、Unable to find a module, a module dependency、ランドマックスマクロマクロスがインポート、まあ勝手に見つかんないというか、マクロマクロスインポートしないですね、よく考えると思ったけど、ここはするのかな、えっとそうか、ずっとスタンプルに一番軽量なのを使ってみますか、プロジェクトを1個作って、それで、えっと、MacOSアップデートだね、テストマクロ、テストマクロスという感じにして、それでこれをどこに作りますかね、ランドマック、ドキュメントの中、ドキュメントの中ですけど、ドキ このパッケージを作って、それでここでSwiftマクロ、これでSyncシステムは別にいいかな、これでドキュメントの中のこのランドマックスと同じような感じで、テストマクロスの中に入れる、これをやればいいのか、テストマクロスの中にマイマクロというのを入れてみるという感じですよね、そしたら出るとSwiftシンタックスがパッケージディペンデンシーとして入って、で、マイマクロがモジュールとして入って、このパッケージとしてはこの辺ですね、これはいいですね、この辺は適当にできたので良いとして、それでマクロ、マイマクロの定義、これは特にインポートしてないですね、マイマクロではインポートしてい だからここ、僕はどこかというと具体的にランドマックスマクロですよね、この中で別にランドマックスマクロ、マクロスなんてインポートしなかったですね、ただこうするとビルドがダメなのではなかったの、確か ですよね、反応が悪いビルド、ユーザーインフォーアクセサー、あれ違うわ、これはもうビルドが通ったという感じですか、ビルドが通ってユーザーインフォーアクセサーが見つからないという状況になったんですかね、ランドマックスマクロ、ビルドが失敗してそうに見える、まずマクロだけビルドを対象にしてみますかね、ランドマックスマクロ、クライアントにしましょうか、クライアントにしてビルドをかけてあげると、これでストリングファイがない、そりゃそうですよね、それは加速したのでない、なのでここはちょっと抜きにして、これでビルドをかけてあげて、そうしたときに、今見逃してしまった、 ビルドがどこだっけな、これね、文字とかできないじゃないとかふと思ったんですけど、これで例えば、iOS1、いやマクOSでいいや、これでビルドをかけると、ビルドが、通りましたね、この前何だったんだったの、何なんでしょう、インポートを間違えていたというかそれだけでしたね、はい、そんな感じでいいや、上手くいったならありがたい、じゃあこれで、実装は何も作っていないからですね、なのでやりたいこと、セットアップからマクロパケティのほうだけでやりますか、これはやりたいんですよ、今、ノーティフィケーションコンテンツというのをね、ショップペアに沿ってこうやってマレージしてるんですけど、作ったやつありますよね、その中でユーザーインフォー の頭の中で考えて作っていくのが、意外としんどいのと、頭を間違えるとね、ちょっと厄介なことになるね、その中で、この列挙型、これですね、アイテムの中、コンテンツのアイテムとか、アイテムじゃないほうがいいかな、ユーザーインフォー、コンテンツの、ユーザーインフォーにしましょうか、ね、コンテンツの中のユーザーインフォーの中の、APSの中のタイトル、それはストリング型でやれるみたいなね、こういうふうな構造をできるようにしようかなっていうね、そんな感じ、今ここ見てもみましたけど、ユーザーインフォーがバーである必要が全くない が、ちゃんと動くようにというのをね、やっていくので、これですね、ユーザーインフォーアクセサ、この部分を作っていく、で、この作っていくのを、まさにマクロを作るためのパッケージ、長松マクロね、この中のマクロクライアント、この中で作っていこうという感じにするので、えーと、あ、そうか、マクロで作っていこうもそうなんですけど、あ、テスト作らせなかったですね、マクロのテストで済ませたほうが、本来はよかったですね、まあ今回はいいや、とにかくこれをエクステンションだけど、ここではプラスかな、フィナル、プラス、ね、こんな感じで、型に対してユーザーインフォーアクセサというのを オプショナルにするかどうかで制御できるし、まあ今回そこまでいらないから、こんな繁栄的なものを作りたいわけではないのでね、これだけにしましょう、で、こうしたときにテストをしていくわけですが、ユーザーインフォーがどんなものかっていうのを、どうしようかな、ユーザーインフォーアクセサ、えーと、うん、名前もなんか迷いますね、ユーザーインフォーアクセサか、それか うーん、なんかあるかな、ユーザーインフォーのこと別の名前だとテクショナリとかをプロパティリストとは言わないか、ユーザーインフォープロパティですかね、ここでね、もっと汎用的な名前にして丸書きのユーザーインフォーみたいな感じでプロパティ名を指定するというね、そういった方法もあるのかなと思ったんですけど、まあそこまでは今回はいいか、まあプロを作るときにはもっと汎用的なことを考えて作っていくような気がするんで、まあ今回は固定で、例えばレッド、ユーザーインフォーみたいな感じでね、これでトリング、エニーとして両方に持たせていく ちょっとしんどそうね、まずはこれぐらいにしますか、この中で情報を持っておいて欲しいのか、要はテストしたいので、これとしては例えば 本番環境に真似ておきますか、トランドマークの何でしたっけね、さっきの箱だ、APSというのがあって、APSに対してテクショナリがこうしてあって、APSの中にアラートですね、 両文字列を持ち列にして、アラートも持ち列で、アラートもテクショナリか、なのでテクショナリにして、トリングじゃない、 アラートタイトルとして、テストタイトルというふうにして、アラートのボディか、ボディの中にテストメッセージというふうにして、これがまずトリングエニーですよね、それでここもまずトリングエニーで、 このランドマークIDがユーザーインフォーに直下にあるのが、 ここですね、ユーザーインフォー、ランドマークIDとして、 これがどこら辺か、S型、1001とかこんな感じですかね、 それで定義が他の入力になっているのとバランスが悪いですね、 こうしてあげて、ここでまずトリングエニー、 こんなテストリングエニーが山ほど出てくると、 タイプエリアスしておいたほうがいいと思うんですけど、 今回はテストで、マクロの動作テストで確認するために入れてるだけなんで、 とにかく本番環境のユーザーインフォーと同等のものを作って、 これからこの本番環境と同等のアクセサというのかな、 こういったものを実装するというのをマクロに任せる。 このマクロへの任せ方はこういう形ですね。 なので、この辺が分かりにくいから、実際はユーザーインフォーが別のところから与えられていて、 中身はもう1回まで見ていく感じなんで、 これはこれとして、この中に入れてると、何かね、わざわざそんなマクロでやる必要あるのみたいな感じになっちゃう気がするんで、 まあいいか、むしろインナモを外に出しますか。 これで、アップユーザーインフォーですね、これを外に出して、 それでエクステンション、で、ノーティフィクションコンテンツをしてあげて、この中に実装していく。 この時に、インナモは別に外に対して発揮するものではないので、プライベートでですね、 プライベートインナモにして、その中はこんな感じで用意として、 これで基本コードができますね。これを実装していくわけですけど、 その時にこのユーザーインフォーアクセサを設定したコード、 これがどういったものなのか、構造なのかというのを見ておかないと、Swift Syntaxを使ってアクセスが難しくなってくるんで、 これはやっていかないといけないですね。見ていかないといけないんですが、 その時にSwift AST Explorerという素敵サービスがあるので、これをアクセスして、 それで、この中にさっきコピーしたコードを貼ってあげると、右側にこうやって構造が出てきて、 これをSwift Syntaxでアクセスしていく。 なので、まずはコードブロックアイテム、この中からユーザーインフォーという劣強型を見つけていくという感じですね。 メンバーブロックか、メンバーブロックの中。これを見つけていくという形を取るんですが、 その時に、Syntax Workerでしたっけ。 こいつのを使うと、確かいい感じだったと思うんで、テストマクロは、いや、あっちですね。 この中で作っていきますが、まずターゲットをランドマークスマクロクライアントにすることで、 とりあえず、軽量なビルドができるようにした状態にした上で、その上でこの中で、ランドマークスマクロ。 この中は、あ、違う。ここはインターフェース制限だ。 この中で作るものは、エクスターナルマクロで、ネームは固定なしで、アタッチブルマクロですね。 このランドマークスマクロマクロス、その辺で定義を作っていって、ユーザーインフォーアクセサーをここに作っていきますが、 この中で、ユーザーインフォーアクセサーのエクスパンション、これですね。 ちょっと長々としていますが、これを作っていく。 この中で大事になってくるのが、ノードは、アトリビュート、Syntax、アタッチブル、デクラレーション、ここですね。 デクラレーション、この中にいろいろ、さっきのASTが入ってくる感じですかね。 Providing Expansions of Type、あとね、 Providing Extensions of Type、エクスパンション、エクステンションマクロだから、 どれに適用しているかみたいな感じですかね。 エクステンションしているかの情報みたいな感じですかね。 とりあえずね、この辺りをいっぱいデバッガーで込めて様子を見てみましょうか。 どんな情報が入っているのかね。と思ったら、ビルドに失敗した。 このデフィケーションコンテンツに貼り付けることができない。 エクステンションマクロ、キャノンとアタッチブルエクステンション。 エクステンションマクロは他にできないのか。 メンバーマクロかな、そうすると。 エクステンションマクロ。 エクステンションマクロじゃないですね。 まっ、これはいいね。 マクロの種類、この前調べましたよね。 これで、デクラレーション、フリーサンディングデクラレーション。 エクスペンションマクロ、コードアイテムマクロ。 できたのかな、出たのか。 とにかくアクセスターマクロ。 プロパティ宣言に対して付与して、なるほど。 メンバーマクロ。 様々なことができる。 これの継承ですよね。 メンバーマクロ。 これか。 ここでいろんなものを追加する。 メンバーマクロかもしれないですね。 バードイビフではないですね。 ピアーマクロでもないですね。 ナディスコップに色々書いていくことができる。 これでもいいのかもしれないですが。 エクステンションマクロは型宣言に付ける。 やっぱり間違ってますね。 コンフォーマンスマクロ。 コンフォーマンスマクロじゃなくて。 もう一回進めていきましょう。 とにかくマクロの種類を間違ったということが分かったので、 マクロマクロ数の前にマクロ宣言ですね。 エクステンションマクロじゃなくて。 メンバーマクロですね。 メンバーマクロで。 マクロの名前はいいですね。 マクロマクロスというタイプアクセサー。 この型でメンバーマクロですね。 メンバーマクロ。 そうすると要求するインターフェースが一緒なのかな。 一回消しておきましょう。 これでビルドは失敗するはずとなる。 ビルド取ったのか。 メンバーマクロ。 ディフォルトインプリメンテーションができる。 ディフォルトインプリメンテーションができるセットなのか。 スパンションが入らない。 スパン。 メンバーマクロの要求を見ていくとか取っていきますが。 これでスパンションが2つありますね。 1つ目がノードとプロバイティングメンバーオフとインコンテキスト。 もう1個がノードデクラレーションオファミングトゥコンテキスト。 どれが一番。 プロバイティングメンバーオファミングトゥがあるかないかみたいな感じかな。 とりあえず上の方で今コピーした方が良さそう。 デクラメーターノードがマクロのスタムアトリビューとかドリル。 デクラレーションがマクロが実装したところですね。 だからこのデクラレーションが今回見ていきたいところ。 なのでこれを貼り付けてこれを実装していくよという感じですね。 ビルドが開けると。 エロか。 インプリメンテーションプロバイティングコンフォーミングか。 どっちを付けろって言ってるのかな。 どっちかっていうと。 知らない。 そうしておきますか。 上の方をコピーして。 それをこの宣言に貼ってあげると。 で、何かこう。 あ、やだ。 こっちね。 何かこう入れて。 これでビルド失敗した。 戻り中の。 あ、はいはい。 なるほど。 これはこれ。 で、これでビルドが終わって戻っていかないよって。 それだけですね。 そしたらここでよくて。 とりあえず何も返さないにするとビルドが取れますね。 で、そしたらこの中のデクラレーションを辿っていくわけですけど。 デクラレーションを辿るにしても。 エクスプローラーがっていく感じ。 アウォーカーがっていく感じだったと思うんですが。 とにかくゾースコードエクステンション。 この中身からですかね。 エクステンションデクルの中のメンバーブロック。 メンバーブロックの中に。 メンバーブロックアイテムリストがあって。 で、それでその中にメンバーブロックアイテムがあって。 で、それでEナムテクルがありますよ。 これを探していくわけですよね。 ただしこのEナムが全て埋めるというか。 必ずこれ1個だけばいいんだよね。 これをちゃんと探していかないといけない。 そうした時にどうやるのかな。 メンバーブロックでしょ。 メンバーブロックアイテム。 で、あと中をどんどん辿っていくことになるから。 まだ早いですかね。 Eナムを。 メンバーブロックアイテムリスト。 メンバーブロック。 どうかと言うとやりやすいのかな。 とりあえずメンバーブロックは絶対ありますよね。 ここね。 メンバーブロックから始まってるのかをまず見てみたい気がしますね。 これを実行。 やってみて、そうするとデバッグが止まると思うんですけど。 これで動いて、終わった。 マクロの展開はどうなるのか。 そしたらこの戻り値の中で、ここでローとして。 ローとしてコメントか。 コメントのローとしてデクラレーション。 デクラレーションディスクリプションかな。 これでビルドかけると失敗。 デクラレーションがここか。 デクラレーションがファイルスコープだけと言われているか。 これをちょっと展開してみましょうか。 マクロ、エクスパンドマクロ。 そうすると、別に何も出てこなかった。 ここは関係ない。 ここは日本だからこれはいいな。 こっちですね。 ここをエクスパンドマクロ。 ユーザーインフォーアクセサーの中で、 一応展開やってみますか。 エクスパンドマクロ。 展開されてますよね、これでね。 これだった。 コメントじゃなくてコメントなど全部が得られているのか。 なるほど、どうなるのかな。 ユーザーインフォーアクセサーでこれがコメント業など全部展開された。 ローにしたからいけないのかな。 これをローじゃなくて対応になっているのがいけないのか。 だからこれをコメント業コメントにして、 これでコメントコードを書いてあげれば、 これでコメントになりそうね。 このバランスが悪そうに見えるかどうすればいいのか。 押してあげて、ビルドをかけて、 これは外に出ちゃっているね。 これでコメントの中でここから始まり、最後終了する。 これでビルドをかけると、ビルドはどうなったか。 キーを間違えた。 ビルドをかけるとビルドが取れましたね。 そしたら動作テスト、クライアントのメインですね。 この中で、これをExpansion、Expansion。 どうすると何も出てこない。 このNotificationContent、出てこなかったか。 ビルドをもう一回かけて、これでExpansion、ExpandMacro。 出てこなかったね。これがうまくいかなかったか。 きっとどうしようかな。RowDeclaration。 これでできないか。これローがおかしいのかな。 ローをちょっとやめてみて、ビルドをかけて。 ビルドは失敗しますよね、これだとね。 何かローが必要ですか。 ローが必要で、これで出力してほしいなという感じなんですけど、 できなかったですね。 ビルドをかけて、このMacroのExpansion、出てこないな。 この前にちょっと変えて、コードというか書き込んで。 そうすると無視するわけにもいかんでしょうと思ったけど、 そんなことないな。 DeclareSyntax。これで概要というか要素でしょうね。 これで中身がこんなに畳めることでしょうか。 これが邪魔そうかな。 そして出て、ビルドを押してあげたときに Expandできるといいんですけどね。 Expand、なぜか。 ここになんでAIが出てくるんだ。 ExplainDocument。まあいいか。 別れたとダメなんだ。どうか。 そうするとコメント行を行に合わせて使えるのかな。 そうするとやることとしては、これざっくりとやっていいのかな。 それでDeclarationのDescriptionの、ちょっと長くなるから今日変えますかね。 このMap、Mapじゃない、SplitでSeparatorがNNかな。 それに対してMaxSplitだとでもいいですね。 で、OmittingEmptySequenceD2はFalseですね。 こんな感じにして。 こうしたらMapですね。 Mapの中ではダブルポーテーションで始まり、コメント行で通用として、 その中に文字列、だから7、0でいいんですかね。 こういう風にして、これでDeclarationしたやつをExpress syntaxにして返せって言いますよね。 なので、これLowValueとかLowですね。 こうすることによって、各行をコメントで出せるんじゃないかなという状況。 これでExpandマクロ、出てこないか。 一回閉じないとダメみたいな。 抜いたわなかな。 これでメインをもう一回開き直して、それでここでExpand。 押してあげたときは出てこないね。どうか。 これでダメなのか。 これの中でMapするけど、まずでは一回ここでテストっていう風にコメントを書いて、 この後の行をコメントアウトしちゃうとする。 例えばね、これだけだとダメだ。 これは配列にしないといけないんでね。 こうやって入れると。 これ上手く言ってましたよね、さっきね。 これでビルドを出ないExpandマクロをすると、あれ出てこないの。 ランドマークズマクロ、ここですよね。 ここでこれが上手くいった気がするんだけどな。 Expansion ofで、それでここで展開がされていないExpandマクロ。 もう一回。出てこなかった。 一回閉じて、もう一回開いてExpandマクロ。 これを展開。出てこないですね。 でもこれを間違ってテストだけみたいにすると、 たぶんこれでエラーになると思うんですよね。 そうするとエラーになりますよね。 Keyword Instance。 とにかくここのテストというか、マクロ。 展開できないね。 展開できないと困るな。 展開しないんですよね。 展開できないのか。 展開。あれ、なんでだろう。 もう一回手直す。これで。 クローのクライアントのメインでExpandマクロ。 出てこないね。Expandマクロしたときに AIが動きたがってるけど。 出てこないな。さっきのエラーの場所を見れば、 何かいいことがあるかもしれない。 ここ。出てきた。押したら出てきましたね。 このときのこれはExpandじゃないのか。 ユーザーインフォー。 どこに展開されているのか。 ここにパーツが出てますね。 中身としては拡張の中ですね。 だからこれのはずなんですよね。 Expand。あれ、何か違うのかな。 Expandマクロがあってますよね。 うん。あってる。 わざとエラー出さないとダメかな。 そうすると、やるべきことは、このわざとエラーを 出したのをプラスすることのコメントたち。 一応ここに鍵を入れておきますか。 これでビルドをかけたときにエラーになって、 このエラーを見ると、 テスト3だけ。テスト3だけらしいとか。 テスト3。テスト3は今適当に言った。 自分がテストテストなど3か。 3つ出てきてるだけでね。 このエクラレーションが 動かなかったという感じか。 そうすると、どうしますかね。 これもう1個開業を入れてみて、ビルドをかけて、 エラーの部分を確認して、もうテストしかないですね。 あとは考えられることとして、同様にここでドローにして エクラレーション、デクラレーション、ディスクリプションをしてあげて、 開業をかけて、もう1回かけますか。 こうすれば余計なエラーが1個出ますよね。 どうもだけどテストなど出て、 あとはコメントにならないのがいいんだ。 こうやって全部ですね、とにかくね。 なのでそうするとエクスプローラ的に見れるのは、ここからですね。 ここからどころか、この上からですね。 そうすると、その上からエクスプローラで ちゃんと見ておけますか。 こうしたときに、コードプロパイティブリストから始まって、 それでエクステンションベクルをまず探したいという感じですかね。 エクステンションベクルなんですよね。 クラス、パターンの場合もあるんで、そうするとプラスベクルですよね。 だからそうすると最初に見つけたいのは、この中のプラスベクル、この中のメンバーブロックですね。 このメンバーブロックを探すにはどうするといいんだろう。 昔マクロやったときはどうだったかな。とりあえず探してみると。 コードが戻れない、マクロマクロスコードですね。 この中で探していくというか、ユーザーインフォワクセサー、この中ですね。 これでどうやっていくか、この出力はとりあえず取っておくかな、どうだろう。 いっぱいなくしたって、それでこのデクラレーションですね。 デクラレーションの機能として何があるか、まず調べられるのと、メンバーブロックありますね。 メンバーブロック、これを大体ですね、メンバーブロックを取ってあげて、これを出力するとどうなるんだろう。 出力用のものがファンクションで欲しいですね。 なのでどうしようかな、まだ応募がつかないので、実装が。 ファイルを適当に作って、まずはここに、なのでドリフトファイルで、ユーザーインフォワクセサー、インプリメンテーションじゃないな、 添付にしますか、とにかくもうどうでもいいという感じで、あとで整理するというのか。 あからさまに分かったほうがありがたい。 これで良しとして、それでこの中にインプリメンテーション、違う、インポート、これを拝借しておいて、 その中でファンクションでメイク、エクル、エンタックシーズみたいな感じで、エクルシンタックスを作っておいて、 これで何を出したいか、とにかく意外と面倒ですね。 これでどうしようかな、エンタックシーズメイクか。 これで意外と面倒だな。これはいいにして、とにかくメンバーブロック、これが本当にメンバーブロックなのか。 例えばオプションになるかな、メンバーブロックはゲットセットした。 なのでこうしてあげて、メンバーブロックが取れてると思うんですけど、 これを中身を見たいわけですよ、なのでリターンとして配列にして、 その中でここでもう一度したいわけですが、ロウにして、デクラレーション、メンバーブロック、ディスクリプション。 これでビルドが出るとエラーになると思うんですけど、これでエラーになったところを見ると、 ブロックが取れてますね。この中からレキュバターを取りたい。 この中でメンバーブロックが取れた。メンバーブロックの中。 ブロックアイテムリストですね。この中にメンバーブロックアイテムとして、イーノムティックルが色々出てくるはずなので、 これをサービスすると、何かいいメソッドがありますかね。 メンバーズ。メンバーズいけそうですね。メンバーブロックアイテムリストしたら、キスポイですね。 メンバーズに対して、これに対してできることというと、ファーストウェアとかが無くと、 フィルターが効くという中で、できるとすると、 メンバーを取って、メンバーを取っていきますか。 メンバーインメンバーズ、こうしてあげて、この中でウェアですかね。 ウェア、メンバーのメンバー、ここで取れないか。 メンバーの、取れてないですね。メンバーズは、メンバーズは、これだから、わからないな。 これを一旦ビルドかけてみますか。ビルドが取れますよね。 メンバーの保管を期待してるんですけど、なんで保管できないんだろう。 ナビゲーションのwithオプションが、セパレーターエディターページ。 セパレーターネクスト、ネクストエディターページ。 ネクストエディターページ。 メンバーブロックシンパック数の中はこれがシーケースになっているはずで、 シザクスコレクションが、まあいいや、それで、それでチルドレンとして。 いろいろあるのかな。 どっちか間違えた、コメント見ると間違えた。 その上の方で、メンバーブロックアイテムリストシンタックス、 これが、それだ、メンバーブロックアイテムシンタックス。 メンバーブロックアイテムシンタックスの定義を取ると、 取れているはずで、これが持っているメソッドとしては、 ハズとか持ってないのかな。テクル?テクル持っているのか、 そうなんだ、テクルがどればいいですね。 なので、ここでメンバー、ブロックのメンバーズで、 メンバー、テクル、ハズかここで、 ハズ、ハズ、ハズになっちゃうのか、ハズは、 なるほど。 そうすると、ウェアではできない、できないはいい次だけど、 テクルメンバーとか、ここウェアでラグしようと思ったけど、 できなそうね。このまま行きましょう。 この中で、IF、レッドじゃないか、ガード、ガード、レッド、 テクル、テクルイコール、またテクルだけど、 イーナムテクルかいいかな、イーナムテクルイコール、 テクルって書いてもいいと思うんですけどね。 リストシンタックスって、それと同様の大事なASIOと書くライブラリーなんですけどね。 読み書きするライブラリーなんですけど、 それがAPIデザインガイドラインに沿ってないというのがすごく気になるんですけどね。 まあまあ、いいか。テクル、イーナム、いや、ここはそれだほうがいい気がしますね。 まあ、そんなことないかな。イーナムテク、テクラ、テクル、テクラレーション、 こういう風な名前ですね、APIデザインガイドラインとするとね。 これでイコールメンバーの、メンバーのテクル、ハズ、 いいんだと思うんですよね。テクルシンタックスが適する、適だとれば、 テクルシンタックスの中で、ハズがあると思うんですよね。 ということで、ハズプロトコルじゃなくて、ハズ、ハズだけだと思うんですが、 ヒズがあって、ハズが来ますね。来ましたね。 これで、イーナムシンタック、イーナムテクルシンタックスが 適用じゃなかった場合にはコンティニューですね。 これで、この中身が列挙型を探すになると思うんですよね。 で、列挙型を探したとなったときに、次にやることは名前が、 今回の仕様ではね、ユーザーインフォーを探したいんで、これを探していく。 まあ、この上のカードと一緒にするっていうのも全然あるんですけど、 そうするとね、デクラレーションがイーナムじゃなかったときか、 それともその名前が一致しなかったときか、みたいなのがわからなくなる。 わからなくなるって言うんですけどね。 ユーザーインフォー、イーナムを探そうとしているのか、 それともイーナムを探して、それがユーザーインフォーであるかを知りたいかっていうね、 その、頭の中の問題だと思うんで。 まあ、だからまとめとしても問題ない気がしてきましたね。 で、来た。どうしますか。 かまうって、イーナムデクラレーションのネームってあるんじゃないかな。 他のが聞いてない。 ネーム、あ、でもありましたね。 デクルネームとネームがあるね。 何だろう。ネーム、ネームとデクルネーム。 悩みますよね、これ。 イーナムデクルの、イーナムのユーザーインフォー。 どうにか言ってないね。 そうすると、ネームか。 とりあえずネームをやってみますか。 で、これでネームがユーザーインフォーであるかっていうね、 こういった条件をつけて、 それじゃなかったらコンティニューでしょね。 それで、見つかった場合だとき、アンリターンしてみます。 それからね、ローのトローボ。 もうちょっといいのあるはずなんですけど、まあいいや。 えーと、この中で。 何だっけ。イーナムテクラレーションのディスクリプション。 これで大丈夫かな。 ビルドをかけて、で、そうするとここが、ローが、あ、そうか。 うーんと入りつかったね。 こうしてあげて、これでビルドをかける。 で、そうすると、展開エラーでしょね。 展開エラーなんですが、ここで展開されたものによると、 これブロックが絵に入ってる。 えーと、でもイーナム、あ、これはブロックか。 こっち行っちゃった感じですね、きっとね。 なので、これをバリアステストみたいにすると、 これでビルドかけるとこっちの結果が安全に変わってくる。 一回閉じて、展開。 展開されなくなったのバグですよね、きっとね。 ディスクリプションになっちゃってますよね。 なので、今この上の条件変わるのがですね、 ちょっとユーザーインフォーの条件を一回消してみますか。 これでビルドをかけてどういうエラーになるか。 そうすると、これが見つけましたね。 だからネームが間違ってますね。 とにかく展開されたのが、プライベートイーナム。 これが展開されたということは見つけた。 いいですね。ここまでかなり良いですね。 そうすると、イーナム デクラレーションのネームじゃないのかデクルネームなんですかね。 あれ、なんだっけ。ネー�ムのネーム。 デクルネーム。Token Syntaxでしょ。 Token Syntaxのデクルネームですよね。 Token Syntax のデクルネーム。 両方見てみれば、良いのか。 デクルネーム デクロレーションは一旦やめて。 この時、ガードのロドのイーナムデクルレーションのディスクリプションですがそうじゃなくて、 イーナムデクレレーションのネームのディスクリプションをまず見てみて、どんなネームが取れているのか。 ユーザーインフォが取れてますね。 また、投稿が間違ってるというか、デクルネームは何なのかというね。 これが一体ですね。 ビルドをかけると、どっちも一緒なのかな。 とりあえずそうすると、ネームが取れてそうだから、 これでイーナムデクレレーションのネームの、どのまま取るからいけないのかな。 デスクリプション。 これがユーザーインフォ。 これだったら、ちゃんとうまくいくんじゃない。 これを一回閉じて、これを一回開いて、 デクレレーションネームのディスクリプション。 これが引っかかんないか。 まとめのちょっとやめてみますね。 これをやめて、ここでスイッチ。 スイッチ。 イーナムデクレレーション。 長いね。 早く引っかくなってきましたね。 でもいいか。 イーナムいいのかな。 これがユーザーインフォだったならば、 リターンAとして、 そうじゃなかったらリターンBとして。 こういう風にしてます。 要素を見ますか。 これでAで当て欲しいってことですが、 ビルドが当てた時にこのマクロ展開が、 これね、閉じて、開いて、 ダメか。 そうすると一回このファイル自体を開いて、 エラーを開くと、 Bですね。 失敗してますね。 これを何とかしたい。 Bの時はBだと分かりにくい。 Bの後にこうしますか。 これでイーナムデクレレーション。 Aで当てた時にこのBの値は、 Bでね、イーナムデクレレーションじゃなくて、 ネームですね。 欲しいのね。 これでビルドをかけて、 それで、もう一回ここを一つずつに押しても、 ダメですがね。 ダメなのか、なんか別のが出てる気がしないでもないですが、 ファイルがここにあった。 ここですね。 一回閉じて、もう一回開いて。 そうそう、Bのユーザーインフォ。 取れてるはずなのに、このユーザーインフォが 合致しないっていうのは、型のせいですよね。 デクレレーションのネームが、型は、 オープンシンタックスか。 なので、オープンシンタックスができる能力。 オープンシンタックス、オープンシンタックス。 これが文字列をね、安定する機会が ちゃんとあると思うんですよね。 昔、言ったときね。 オープンビューじゃなくて、イニシャライザーがあって、 エキストが適当ですね。 これですね。 ネームのエキストがユーザーインフォであるか。 これを見て、ビルドをかけて、 そうすると、ビルドエラーで見てみると、 見てみると、Aになった。 はい、合致しましたね。 なので、これで合致したので、ガードに変えましょう。 ガード。 ガード。 こうじゃなかった場合には、コンティニューで再び。 ユーザーインフォじゃなかったら、続けますよ。 これも合体しても良さそうですけどね。 イーナムデクラレーションを取って。 でも、デクラレーションの時に、 今出したので、分離しておきましょう。 こうしておくと、これでイーナムが取れました。 ユーザーインフォのイーナムが取れました。 ということで、ここが起点になりますね。 ここから、イーナムを色々と漁っていく。 要は、快速技になってるわけですよね。 なので、これを辿っていくんですが、 この時には、ワーカーが使えそうですね。 それは、クラスでするはずなんですよね。 なので、ここが、ファイナルクラス。 プライベート。 プライベートエクステンションで、ユーザーインフォアクセスと。 これで、ファイナルクラスで。 イーナムデクラレーション。 イーナムをオーバーとして。 ビジターがオーバーというか、ビジターだ。 ビジターだから、名前ビジターにした方が良いですかね。 ビジター。イーナムビジター。 ビジターパターンは、確かオークオークで、 どの方を目的とするかみたいなやつですよね。 なので、オープンパンクだから、オーバーライドですね。 開けば出てくるでしょ。ビジット。 ノードとして。 ここでも出てこないの? そこで、ノードとして。 イーナム、デクル、シンタックス型。 セルフは要らないね。 モードリッジは、 シンタックス。 シンタックス、ビジター、コンティニュアス。 オーバーロード、オーバーライド。 アクション、大前提。 アンクション。 言われてれば正解か、大失敗。 ビジット、デクル、シンタックス。 これで閉じて、もう一回ビジット。 ありがたいオーバーライド。 これ不思議なんですよね。 ソリストシンタックスって難しいからなのかな。 全然、ソリストシンタックスっぽくないですよね。 これでデクル、シンタックスが、 ネットワーカーが辿る度に得られていくけど、 これで階層は分からないのかな。 階層が分からないか。 ビジターパターンでオープンして、 ビジットする度に、 イーナム、デクル、シンタックスが見つかったところで、 エアレントがあるので、 エアレントがあれば十分か。 エアレントがあれば十分だ。 エアレントは、プリングエニーカーだと想定して、 アクセスをしていけばきっと大丈夫。 まずはそれでやっていきましょう。 エアレントがあるという状況で、 まずノードのいろんな情報を入れたいですね。 どうすると、この中でやることとしては、 サンプルはどこだ。これだ。 こうしてあげて、これを順次探していくわけですよ。 ユーザーインフォの中で、イーナムビジターだけど、 名前をもうちょっと変えますかね。 イーナムユーザーインフォ、ユーザーインフォアクセスワーの中の、 コンテイニングイーナムビジターにしますかね。 中身をちょっと見たいので、これでイーナムの名前をまず見たいですよね。 なので、レッドイーナムと、 これがキーになる部分ですね。 だからキーとして戻っちゃっていいのかな。 キーの部分として欲しいのが、ノードのネーム。 ノードのネームのテキスト。 テキストを取っちゃっていいのかな。 まあいいか。これでテキストで、さらにこれが 小文字になることを今回は想定する。 ランドマークID、アクセサリアケースか。 ここが、スネークケースじゃなくて、キャピタルケースじゃなくて、 何ケースでしたっけ。忘れた。 スネークケース、キャピタル、キャメルケースか。 キャメルケース。そうだね、キャメルケース。 スローアーキャメルケースだ。 だから、それぞれの表示の名前だっけね。 スローアーキャメルケースに、 ウィストでローアーキャメルケースコンバート。 表記でありましたっけ。キャメルケースね。 特にはないかな。 ファンデーション入れなかった気がするんだけど、 キャメルケース、ファンデーション入れてないか、 そもそも入れてないですね。 インポートファンデーションして、 ファンデーションで、あそこまで配慮しなくていいのかな。 いやでも、実際作るときは、これ配慮しなくてはいけないと、 バグるんでね。 キャピタライズ、キャピタライズ、キャピタライズって何だっけ。 キャピタライズ、キャピタライズとは、 中で出ましたね。キャピタライズとは、 キャピタライズスペリングで、 キャピタライズって大文字ですよね。 一般に調べておきますか。 ウィスト、キャピタライズにしようかな。 そういったサンプルで作っちゃうのは、 あまり良くない気がしますね。 そうすると、キャメルケース、ウィスト、 ウィストのローアーキャメルケース変換。 そしてあげて、これで変換する。 スネークから変換したわけじゃないんですよね。 なので、キャメル、スネーク、コーダブル。 コーダブルの話ばかりになっちゃうと思うんですが、 スペリング拡張か、これを見ると、 ライフラリーにないというお話かな。 キャメライズ、キャメライズ、まあいいか。 で、スネークケースからね。 これはまあね、できますよね。 キャピタル、キャピタル、キャピタライズ。 できないのか、できないのかとか、 先頭を小文字にすればいいという感じです。 先頭を小文字にすればいいな。 なので、先頭だけを小文字にする。 そうなると面倒ですね。 関数で普通に落ちるんですよね。 まあまあ、先頭だけ小文字。 先頭だけ小文字でテキストを得る。 これ拡張でやっちゃいますか。 エクステンション、エクステンション、 ストーリングプロトコルでいけるかな。 ちょっとやってみましょう。 で、ファンクションなんですが、 効率も考えて使い捨てると考えると、コンシューミングファンクション。 で、それで、えーっと、 キャピタライズの反対っていうのが、 カメルケースに、ロアー、カメルケース。 先頭を小文字にするだけなんですけど、ロアーパースト、 ロアー、エキスト、ロアーキャメル。 先頭だけロアーキャメル。 チャピタライズ、んー、キャピタライズじゃないね。 先頭を小文字にする。 ロアートゥー、トゥーはあんまり使いたくないんですけどね。 ロアーコンシューミングファンクション。 これはプロパティですね。 プロパティか、コンシューミングプロパティっていうのは、 バーが先にかな?コンシューミングケースかな?それで、なんか自信がないね。 バーで、ロアー、えーっと、まあいいか。 キャメル、ロアー、ロアー、キャメル、ケース、キャメルケースで。 ちょっと、なんか土平を招きそうな雰囲気を感じるんですが、 これでいくのでストリングプロトコルですが、ストリングプロトコルだと、 セルフ、セルフでいけるかな?自分を書き換えるということができるのかどうか。 まあやってみましょう。 これでコンシューミングケースで、それでセルフの0番目の前にガードがいる。 オプショナルじゃないけど、エンプティだとダメですよね。 カード、ノート、エンプティ、エルス、リターン、セルフですね。 まずね、空文字を返すだけ。 セルフを返すというか、空文字、いやセルフでいいな。 セルフで、一番、あの、空文字返すよりセルフ返した方がね、 コンシューミングケースの場合は盛り付くはずなので、こうしてあげて。 で、それで無駄になった場合には、エルフの0番目を小文字にするには、 ASCII文字の小文字にする。 他の文字どうだったかな。 キャラクターですね。 だから、ガード、ガード、エルフの0番目、 エルス、リターン、エルフ。 ここまで、誘導をかけてみましたね。 ASCIIコードだとね、ASCIIコードが前提になるはずで、今回の場合ね。 で、それでASCIIコードの場合って、論理演算で大文字小文字変えられるじゃないですか。 大文字、小文字、論理演算、すごい雑な検索しますが、 これで出てくると思うんですよ。 で、これで変換、変換が欲しいか、変換。 リフト部分っていうのかな、これですね。 XOR、XORで入れ替える、入れ替えなくていいんだけど、 そっか、XORで入れ替えられるのかな。 えっと、これをXORすると、あ、なるほどね。 どっちだ、とにかくこのフラグ、このフラグが1なのか0なのかですよね。 だからこれでASCIIコード表みたいなのがわかる。 ASCIIコード表、ASCIIコードとしてこれを見ると。 論理演算、大文字の方が先に出てますね。 で、それで、Aが0X41ですよね。 で、小文字のAが0X61、0X4から6ってことは、 0、0、あ、上位のさっきのフラグが追加されてれば良いってことですね。 なので、そうするとASCIIコードということが分かった以上、 アルファベットを習ってやった方が雰囲気的にいいんですかね。 ASCIIコードで、これを、だから三述論理演算なので、ORイコール、このフラグですかね。 で、そうしてあげると、小文字になる。 小文字になったら全部リタンセルフですね。 全部リタンセルフか、ってことは、ガードのソーキーグリップにするか、 UFOにするか。ここがUFOなんですが、コンシューミングの場合は、 自分が聞かれている前提からいけるので、 IFとISEMPTYかつ、セルフの0番目とかFIRST取れるんですかね。 FIRSTをいけますね、FIRST。でもセルフの0番目の方が早いと思うんですけどね。 いつASCII、えーと、これが、あれ、えーと、これはダメなのかな。 えーと、まあ、いや、できるつもりで、この時に論理演算で、最初がね、1文字以上あって、 最初がASCIIコードだった場合は、大文字に変換。 これを下上でリタンセルフすればね、これで完成ですよね。 ビルドをして、ここが、えーと、なんだこれ、カッコが足りない。ここがビルドをして、ビルドフェイル。 うん、良さそうですね。本当かな。本当にできるのかこれ。 で、これでテキストのLowerCamelCase、LowerCase、LowerCaseが全部をLowerにするんですよね。 ローカライズでLowerCaseってなんだ、えーと、ロケル。 LowerCamelCaseが今作ったやつ、LowerCaseとビルドってなんだ、ロケルが。 そうできた、これですね。 こうしてあげたときにビルドをかけると、うん、足りないよね。 できたっぽい、本当かな。ここがエラーになってる。えーと、ここが、SubScriptを、Engi、0、0、あと、これがStartIndexか、StartIndex。 こうしてあげると、ビルドエラー。これは、このエラーは、キャラクターから、あー、インディザー。 あ、そっか、キャラクターか、キャラクターからインディザーだね。なるほど。 論理演算ではダメだったということですがね、という感じだと、 まあ、あともう1回書き換えればいいですかね。 8イコール、えーと、セルフ、スタートインデックス。がんばりきれいなコードじゃないですね。 スタートインデックスの、えーと、コード、なんだろう、えーと、あー、スキーコードじゃなくて、ユニコードから。 ユニコードスカラーは、形的には、ユニコードスカラーは、なんだこれ、これで聞きたいと違うな。 えーと、ユニコードスカラー、スカラーとか。 えーと、他のが聞かないとつらいですね。 でもまあ、キャラクターだからいいや。 キャラクター、このキャラクターをね、コモジンにするというのが簡単にできれば、これでいいんですけど、 とりあえずこれでキャラクターは、あの、UTF-8か、UTF-8消そうですね。 UTF-8からこの後は、キャラクターのユニコードスカラーが あるはずなんですけど、ユニコードスカラーは、どっちがいいかな、UTF-8。 UTF-8をキャラクターに変換できるならですが、どれがいいかな、キャラクターのイニシャライザー。 イニシャライザーは、エミットコンテンツ、ユニコードスカラーが取れましたね。 で、それでキャラクタードリング。 コモジンとか、こんな苦労しなくていい気がしますね。 まあ、いいか。 キャラクターに対して、UTF-8はユニコードスカラーがいいですね。 ユニコードスカラーの中に、ユニコードスカラービュージョンを作っていいんですが、 ユニコードスカラーは中にバイオを持っていると思うんですけど、 意外と面倒ですね。 コモジコモジの変換か。 そうすると、リフレーズでやった方が早いという可能性もある気がするんですが、 いやでもこのままやっていきますか。 だからそうすると、ELFでタグインデックスとかキャラクターを持っていったわけですよね。 なので、キャラクターを順次取っていくとなると、 これで、red first first word equal ELFのパートインデックスですよね。 そうしたら、if red first first first first equalでいいかな。 これで、if red firstでいいですね。 これで戦争文字が取れるかどうか、空っぽかどうかわかるんでね。 where first is ASCIIという風にすればいい。 そうすると最初の文字がこれで、これでASCIIか、ASCIIではないけど、 キャラクターが入られているASCIIコードなので、 そうしたらこれを、ユニコードのコードがないと辛いな。 ユニコードのASCIIの、どうだ、firstに例えなかったか。 辛いけど、そうした時は止めろって感じですかね。 キャラクターの、キャラクターの、 どうすればいいのか、アップルする人にしようか。 で、出てきた出てきた。これこれ。 これを見て、このキャラクターの中でユニコード値を取りたいわけで、 ユニコード値はユニコードスパラーズですね。 で、ASCIIバリュー、お、ASCIIバリューありますね。 ASCIIバリューか、これでいいですね。 だから、えーと、ここじゃない。 こっちですね。 なので、firstのASCIIバリュー。 ASCIIバリューは、ASCIIバリューは、 つまりか、だからこれはASCIIバリューでいいんだ。 firstバリュー、バリュー、first、 ASCIIバリュー、イコール、firstの、 firstのASCIIバリューですね。 で、これをすると、ASCIIコードならそれが取れるようなはずなので、 いざ好きとかそういったのの判定もいらなくなって、 やっぱりちゃんと取れている。 で、そうしたら、えーと、ロー、あ、あら、 チェックしてみてください。 レッド、えーと、 firstバリュー、 ASCIIバリュー、 イコール、first、 ASCIIバリュー、 または、 セットしてあげれば、 これで文字になったはず。 ちょっとやってみないと自信はないですが、 あなたが好きなこのnewASCIIバリューをね。 で、そうした上で、このキャラクターをね、セットしていくんで、 レッド、new、キャラクター、キャラクター、 イコール、キャラクターで、これのイニシャライザーがね、 何があるか、えーと、.initを読まないとわからないね。 で、これで、ユニコードスカラーですね。 ユニコードスカラーだと、リテラルがこれ。 ユニコードスカラー、コンテンツがユニコードスカラー。 多分、これである必要があり、ユニコードスカラー、 これは、イニシャライザーは、.init、 initvがintが、ユニコードスカラリテラルがintがとか、 newASCIIバリューがintがとか、できたのかな。 そうするとね、スタートインデックスに対して、 新キャラクターを入れればいいわけじゃないですか。 これでできた、本当かな。 これで、ビルドがとりあえず、.init、 あー、これね、getOnly、ここが、あ、getOnlyか、これ。 ようやくここにたどり着きましたね。 getOnlyね、だから、ストリングプロトコルが エクステンションできないとかですると、ストリング。 これは、ストリング、もう、getOnlyか。 あー、そうなんだ。 そうすると、オンシェアウィングいけないですね。 そんだけやっといて、オンシェアウィングがいけないか。 配列、キャラクターの配列、ああ、そうなのか。 そうしたら、先頭だけ小文字にして作り直すということをね、しないといけないですね。 先頭だけ小文字はこれでいいと思うので、 えーと、つまり、ファーストベッダー、これですよね。 オーダー1で終わるものがプロパティには期待されるので、 そしたものがプロパティだと、それ以上に計算が複雑になってくる場合には、外にしましょうというね、ガイドラインがありますが、でも、オーダー1個。 最初の文字だけを変える、で、残りの文字数によるのか。 まあ、そんなに細かく分かる必要はなさそうですね。 バーにしてお。 これで、ストリングプロパティだけだけど、ストリングを返すようにして、 それで、ここでいろいろ作っていきましょう。 コンシューミング、get、コンシューミングが、そこまでいらないですね。 普通のね、作り直すんでね。 まあ、作り直すからってね。 自分を壊した方が早い時はね、十分あると思うんですけど。 まあ、そんなにね、標準ライブラリを所属権でいじる準備がする人ができていない感じがするので、 効率はあまり良くなさそう。 とりあえずこれで、ファストアスキーバリューが取れるかどうか、これ重要ですよね。 あの手カードを、えっと、ガードレット。 で、それで、アスキーバリューが取れなかった場合は、 これはもうそのまま、リターン、セルフですけど、ストリング、セルフですね。 こんな風にして、文字列を返しましょうでしょ。 で、それで、よくて、で、この後でね、いろいろやっていきましょうということになるわけですが、 この時にやることとしては、えっと、 あ、嘘で、ファストレターだけ取りたいわけだから、ファストレターはもう取ったので、 ニューでこれでキャラクターを新しく作りましたね。 そうしたらこれを連結して文字列になるわけですよね。 だからやることとしては、えっと、キャラクターズ、キャラクターズ、 イコール、えっと最初のワードですよね。なのでこれは、何だっけ、コレクション、コレクションオブワン、でいいですね。 それに対して、ニューキャラクターを渡して、この後足すことの、えっと、自分自身が、なので、 ドロップファースト、ドロップファーストシーケンスしかないのか。 えっと、キャラクターズ、キャラクターズ、 キャラクターズ、ドロップ、何だっけ? ドロップファーストシーケンス、なんかちょっと半端ですね。 あの1個、頭を捨てて残りを欲しいなっていう、それだけなんですけど、それはかなわない。 キャラクター、あとキャラクターか。 まあまあストリングはキャラクターですね。あのシーケンスのね。なので、あそこがストリングだから、ドロップファースト、いけるんじゃないかなってやってみましたけど。 リターンシェイプまで行って、ここじゃないですね。こうしてキャラクターズまで行きましたね。 こうしたらこれで、リターン、あそこが、コレクションオブワンとか言ってる場合じゃなく、文字列にして、 連結するって手もありますね。でもこれでいいのか? 連結、なんかその方が早そうですね。キャラクターじゃなくて、new character、new stringとして、 new character、こうしてあげて、new stringイコールストリングとしてあげて、 これでリターンするときに、new stringプラス、名前割りね、ドロップファースト。 で、ビルドが切れば通ってるんじゃない?通るよね。通ったので、そしたらこのキーが本当になってんのかみたいな、 そういった状況になってくると、うん。 アクセルとか消しましょうって感じでいきますかね。ここの方が下の方がいいけど、 まずはEハードで整理しましょう。これでキーが取れただろうと想定して、キーが取れたら、どれを出したいんだ? キーを取れたら、 ブルーが2本になるのが、これはこっちですよね。 なのでこれでキーが取れたでしょ、Eナムのキーが取れた。 まずここまででいいのか? つまり、これでキーが取れたので、ここをイジットしつつ、ロータスでしていかないといけないので、 ビジターなのでね、最終的に返したいのがテクルシンタックスの配列なので、 これを加えていっちゃいましょう。 ウォーカーにね、ビジターにね。 なのでこれでファイナルクラスでプライベートセットバーですよね。 それに対して、ビジターのエクスパンションかな? エクスパンションで、このテクルシンタックスの配列。 これをイニシャライズ、最初からですよね。 最初はダメだけど、今回からで良さそうね。 こうして用意したこれに追加していくって感じですね。 なので、これは取りたいもの、このサンプルじゃなくて、どれにしますかね。 実際に使う場面か、実際に使いたい場面は、どこだっけ。 ノーティフィケーションコンテンツとか。 だからノーティフィケーションコンテンツのウォッチOSよ。 ウォッチOSか、これ。 ウォッチOSのためだけに結構苦労してるのか。 まあまあ演習だからいいんですけどね。 これで、作りたいのはこれですね。 Eナムのものについては、ストーリング・エニー型で 収束できるような、こういったのを作りたいので。 Tが取れたら、これ。 なのでここで、エクスパンションにエンド。 エンドする内容は、文字列。 文字列リペラル。 それで、プライベートかな。 Eナムの方は、プライベートバー。 ここでできてるのかなってね。 ここでやっぱTが登場してきて、これコロン打って、 ストーリング・エニーですよね。 エニーで、ストーリング・エニーに対してオプショナル。 というプロパティを作って、この中でユーザーインフォ。 これペアレントの名前でしたね。 ペアレントからEナムを取らないといけないのか。 ペアレントはどこになるだろう。 エクスプローラー重要ですね。 構造が重要で、Eナムで来るかって。 これは、ペアレント誰これになっちゃうと、 メンバーブログになっちゃうと困るんですけど。 Eナムで来るペアレント。 その辺は何とでもなる気がするんで。 とりあえず、キーとして、バリューなんだっけな。 インフォ、バリューかな。バリューじゃないね。 プロパティ、プロパティ、プロパティコール。 例えば、ペアレントの、ペアレントのネームできるかな。 ペアレントは、ペアレントの、ペアレントのこれは何だろうね。 シンタックスの型は、ルート。 ペアレントのディスクリプション。 ペアレントのロー。 ペアレントシンタックスノードタイプ。 まず、色々ありますが、ペアレント。 これで、Eナムまで辿ればよいかな。 なので、ちょっとプロパティが難しいので、 えーっとね、これを例えば。 ペアレントノード。 ノードは、このノードは何型でしたっけね。 ノードは、型が、Eナムデクルシンタックスか。 Eナムデクルシンタックスだから、ここでエクステンション、エクステンション、Eナムデクルシンタックス。 この中で、ファンクションDかな。 プロパティ、どっちだろう。 まだデザインガイドラインがないようですが。 どっちがいいかな。 プロパティっぽい気がして、計算力。 今、ドキュメントコメント書いてないんですけど。 ちゃんと書けば、条件、ひたすら重たい条件ですけど。 ちゃんと書き添えすれば、オーダーをちゃんと書けば、 プロパティでもいいって感じのガイドラインになってるんで、どっちのつもりでいきますかね。 なので、バーでペアレント、Eナムデクラレーションという風な感じでね。 これで返すものとして、Eナムデクルシンタックスのオプションライフ。 これをタブにして、それで、ペアレントを辿って行く。 なので、どうしようかな。 ガード、スイッチの方が美しい可能性を感じた。 スイッチ、自分自身のペアレントね。 ペアレントは、ペアレントで、ケース。 先にニルやっちゃいました。ケースニルの場合は、リターンニルですね。 ガードで息をしますね。これで、ペアレントがあったら、全然美しくなかった。 ここで、アタマチで取らないといけないから、ガードレットの方が美しいですね。 ガードレット、ペアレント、エルス。それで、リターンニル。 早く決着付けた方が綺麗ですね。今回はね。 ガードができた。ガードができたら、ペアレントを辿って行くわけですけど。 どうしますかね。 インナムでくる、デクーラレーション、イコール、ペアレント、インナムでくる。 こうだった場合には、インナムが取れたということは、これを返せばいいですね。 デクーラレーション、リターン、デクーラレーション。 そうじゃなかったとすると、さらにペアレントを辿っていくというのをやっていけば良い。 ペアレントに対して、ペアレントインナム。 ペアレントがシンタックスか。 シンタックス。そうすると、ペアレントというか、 コンテーニングかな。 あ、違う。そうするとシンタックスがコンテナーになってそうだから、 エンクロージングかな。 エンクローズってどうなんだろう。 エンクロージング、インナムでくる、デクーラレーション、 インナム、コンテーニング、インナムでいきますね。 デクーラレーションって言わなくても通じそうですね。 これで、ペアレントのインナム、エンクロージングインナムを探していく。 探していけそうな予感がする。 やってみないとわからないけど、それで見つかったらOK。 ペアレントが20になった時点で終わりですね。 リターンがあんまりね、このif式ってそういう人だと あまり使いやすくないんじゃないかなと思うんですけども、 if式になりそうだから、if式にしておきましょう。 これでエンクロージングインナムが取れたら、話がどっかが早くなる。 ここでプロパティネームにしようかな。 プロパティネームとしてノードのペアレントを、 ここはまた書いてあるところかな。 今持っているノードのエンクロージング。 ノードは何かかでしょう。 インナムテクルシンタックスですよね。 インナムテクルシンタックスはシンタックスだと思うんで、 エンクロージングインナムが使えると思うんで、 他がおかしいのだろうが勝手に決め込んで使っていきますが、 ノードに対してエンクロージングインナムですよね。 これはNilが返ってくることがあるから、Nilが返ってきたら、 Nilが返ってきた場合には、ペアレントがないという状況。 ペアレントがない、ペアレントがない、はずがないという状況ですね。 ペアレントがないという状況がないなら、 強制アナログですね。 エンクロージングでキーで、 ユーザーインフォーをやりたいんじゃなくて、 プロパティネームで、 プロパティネームの中のサブスクリプトで、 この中にキーの名前を入れてあげて、 サブスクリプトを読み終わったら、 アーツでストリング・エニーという風にキャストして、 これを丸括弧と打ち入れるということを、 ここでいいのかな、ここで良さそうですね。 という風にして一行ぐらい書き分けときますか。 これでレッド型、つまりストリング・エニーを返す。 インターフェースが整ったはずという気持ちで、 効果が整えられるはずという気持ちで、 他のユーザーインフォーが見つかったところでやっていく。 それと、ビジターイコールイーナム、 コンティニングイーナムビジタービューモードで、 これでビューモードは、他の効かないですね。 ビューモードは、 多分厳密にチェックするかどうかという フラグになるはずなんですけど、 ビジターのビューモードは、ビューモード、ビジット、 ビジター、シンタックスビジター、ここですね。 ビューモード、シンタックス3ビューモードで、 これで、ソースアーキュレイト、フィックスアップ、オール。 これは中途半端でも良しとするか、 でも何でも良い気がしますけどね。 フィックスアップ、オール、フィックスアップは、 これで良い気がしますね。 これが厳密なコードですよね。 そっちの方が安全ですよね、きっとね。 これでビジターができたら、 ビジターに対してウォークですよね。 で、ノードはイーナムデクラレーションですよね。 で、この中をウォークさせていくと、 イーナムデクラレーションだから、この中で探していく。 これでビジターはプラスばかりになった。 これでビジターのエクスパンション。 これでビルドが通せて、 ビルドが通せてもまだエラーですが、 でもだいぶ進捗がありそうね。 見ていくと、あ、Aになってる。 これはエクスパンションして、 Aをどこで出せましたっけ? Aは、しましたよね、たぶんね。 これでビルドをかけて、 あ、この辺が色々ダメなんだ、なるほど。 PかX、மがいるということですね。 mがいるって、こっちのプロパティの エンクロージングどうなってるかどうか。 イーナムデクルシンタックスは いいなのでくるシンタックスってコレに書いて、 探していく感じです。 で、どうなったら イーナムデクルシンタックスは、 軽小関係デクルシンタックス プロトコル。 あとシンタックスノードって言うのか、 これデクルシンタックスプロトコル。 デクルシンタックス プロトコルは、シンタックスプロトコルですね。 シンタックスプロトコルはこれですよ、 という形で、 ロアキャメルケース2がエキストに持たせたってんだ。 だからそうすると、出し方なくエキストでローですね、今ね。 なのでそうすると、エキストのロアキャメルにして、 これはローで、これでいいか。 これでビルドをかけると、アリファーがない。 エクスパンション、はいエクスパンションはペンドーして、 あ、でコンティニューね。はいはいはい、なるほど。 コンティニューはどのフルアポリシーって言って欲しいので、 あ、他の効かない。 えーと、アポリシーって言って欲しいので、 ビルドって言うといいんですね。 これを開けて、で、オッケーだ。 ビルドして、真っ黒が、えーと、リザルトの方、 プラグイン、これがなんか失敗してますね。 これで展開できるかな。 うん。 えーと、リシーブリザルト、プラグインからの リシーブに失敗したという感じで、 それ以上の情報が得られてないですね。 この辺は、この辺は、えーこれは古いやつですね。 で、メインが、うん、なんか失敗してましたね。 えーと、得られたのが間違ったということなので、 名前の変化の、えーと、名前の変化。 ここで、プロパティネームとエンクロージングインナムですね。 これダメですね。 これで、ネームですね、のエキストですね。 で、この名前も、ローアキャメルケース。 ローアキャメルケース。 これで、そうするとここが、ローですね。 で、ビルドをかけて、ビルドが終わっててもまだダメだ。 これ、展開できない、なんでだろう。 補完できないのか分からない。 一回エクスコードを閉じれば、元気になるとかあるかな。 でて、エクスコードを立て上げまして、 ここだけでもね、作れたらいいですけど、 だいぶ時間経ったから、そろそろ、 あれだ、落ちるまでになるかもしれないですが、 ビルドをかけて、ビルドが、 今、やられている最中に、ここを見ておきますか。 えーと、ここが、プライベートバーで、 プラグインのエラーですね。 一回これを閉じてあげて、エラいってあげて、 あ、ランドマークスになった。 これは、今はランドマークスのプライバー。 ここだけでね、見たいので、 ビルドをここでかけて、こっちで見るのはね、 これのエクスパンションがね、できれば、 あれ、エクスパンション、あ、いいな。 エクスパンションができればいいんですけど、 これが、なんか、機能しない。 ここにAIのマークが出てあたりして、これ良いかな。 え、これが確認できないのか、 ちょっと厄介なんですよね。 とりあえず、アペンド、エクスパンションの アペンドとして、プライベートバーで、 Eの名前でしょうです。 ストリング、エニーのオプショナルで、 何かっこ、あ、何かっこで来ないね、ここね。 まだ、これで、何かっこしたのやつか。 あー、ありましたね。 なるほど。 これで、エニーで、かっこで、 エロープロパティーネーム、 で、サブスクリプトの形を取って、 ストリング、エニーのですね。 良さそうな気がするので、 これを一旦コメントアップできるのか。 そうすると、これ全体、コメントをコピーして、 ここコメントアップ、戻ってきたんでね、 コメントアップして、この変数が予測できない感じがするので、 バー、キー、ボロンで、ここもストリング、エニーの戻り地として、 プロパティーネーム、サブスクリプトで、ここもキーにしちゃって、 まずはこれでね、どうなるかをちょっと見てみて、 ビルドをかけて、リサルト、やっぱりエラー出ますね。 リサルトの方で、エラーが出ちゃう。真っ黒。 リサルトがエラー、ビジターパターン、 この辺の問題なのですかね。ビジターで、 例えば、ペアレント、必ずニルにする、 どっちにするのか、要請アラップでね、やってみますか。 リターンテスト効果、リターンテスト効果は何だっけ。 メンバーでリターンする、メンバーデクラレーションで、それでカードで、 イーナムが見つかったら、最初のが見つかったらリターン。 なるほど、なるほど。 1個だけ見つかればいいからこれでいいですね。 それで、いいんだけど、なんかちょっと、 このメンバーを辿る意味が、意味がない気がする。 ここは直すときに考えますよ。 それでビジターのエクスパンションを返すこと。 これがダメなんですよね、きっとね、たぶんね。 なので、ここで試しにリターン1みたいな、 こういう風にすると、エラー1、これはダメなのかな。 入れてしないとダメですね。こうしてあげると、 1だとエラー出ないと困るから、できそうなのにして、 こうすると、戻るとダメって言われますね、この時ね。 ビジターのウォーカーをやめさせる。 こうすると、これは大丈夫だろうか。 なのでビジターのウォーカーがまずいことをしてそうね。 なので、こうしてあげて、ウォークしないで ビルドをかければ大丈夫なわけでしょ。 ビジターのウォーカーが、よくわからんことをしてるんで、 たぶんプロパティネームじゃないかな。 プロパティネームのケースを読めると、これで結構いきますね。 ほら、ここが、やまなくて消して、 こんな感じ、いいですね。 ここら辺をちょっと復活させていきますか。 これを消して、さっきの復活させて、 要は、ウォーカーが、この、ローアウト、 あるいは、プロパティネームをね、 この、エンクロージングインナーも使うことが、 たぶん問題なのかなっていう気がするんで、 トレッド、プロパティ、ネーム、イコール、 まずはテストとかね、やって。 で、ビジターをかけると、ビルドが通るようになってくるのかな、 なんないか、テストって出てくるんでね。 そうそう、こんな感じ。 ユーザーインフォー。 ユーザーインフォー。ユーザーインフォーから来たか。 ユーザーインフォー。 いいのか。よくない。 ユーザーインフォーはプロパティで持ってるんで、 ユーザーインフォーからはいらないです。 渡すノードも違ってます。 なので、渡したいのはユーザーインフォーの後に、 このビジターの多くの、インナムデクラレーションのメンバー、というのか、 インナムデクラレーションの中身を渡したいですね。 メンバーブロックか。メンバーブロックね。 オーバーのビジターのインナムデクラレーションのメンバーブロック。 これでビルドをかけると、ここが1個だけのエラーになって、 そうすると、いいですね。APSだけ演出されて、 このテストがままなってない状況ですけど、これはおそらくは、 プロパティのインナムデクラレーションの計算ですね。 エンクロージングインナムがニルになってるんじゃないかな、という予感を感じる。 ニルだったときは、APSでしょ。それがペアリントが。 ニルだったときには、オプショナルにして、ニルだったときにはユーザーインフォーですね、これね。 エンクロージングインナムがちゃんとできてるのかっていうね。 そこはすごい怖いところなんですが、それを試せばいいのか。 APS。APSがまたさらに何か持てばいいのかな。 とりあえずここまでビルドしていこうとしてますよね。 これでエクスパンションできれば嬉しいんだけど。できた。できましたね。 これでプライベートバー。 これフォーマティックよくないな。 エンドでリダウンするときでしたっけ。 エクスパンション.フォーマティックってなかったっけ。 ないか。フォーマティック。 フォーマティックはないか。どこだったかな。 マップ0のフォーマティックかな。 これダメか。これかたが違ったのかな。 エクルシンタックスに変えられない。 フォーマティックはダメか。 エクルシンタックスではダメ。 ここがインデックがちゃんとされたいといったお話。 フォーマティックはここでどうか。 これで.map.eclustaxに変換できるかな。 これはダメか。赤がダメですね。 それ以限にね。 エクルシンタックス。 譲り間違いなだけかな。 でもダメですね。 そうするとここでシンタックスになったものを 文字列リテラルとストリング。 インターフォレーション。ストリングインターフォレーションでやったけれども。 これでビルドは通るんですけど、 ちゃんとできてる保証はないという感じで。 これを展開してね。 様子を見てみてあってればこれでいい気がする。 エクスパンションマクロ、APSで。 フォーマティックも全然連れてますね。 こんなこと頑張る必要は今回なさそうね。 フォーマティックは忘れてたっけね。 エクルシンタックスでね。 なんか綺麗に合わせられたような気がするんですけど。 ここでフォーマティックみたいなのができたらいいんですが。 フォーマティック、ダメですよね。 まあいいか。 こういう細かいところは目をつぶる感じで良いですかね。 今回はね。 なんていうんだろうな。 エクステンション、エース、まあいいでしょう。 これでアートカプショナル、APSのアンラップでないといけないんだ。 APSのアートね。 なのでこうするとオプショナルか。 なのでオプショナルにするには、 ここら辺のユーザーインフォーじゃなくて、 ロアキャメルケースに対してプラスか。 ここでプラス、アテナできるのかな。 ビルドをかけて、あ、これでダメか。 ロアケースとかオプショナルの可能性ありますね。 だからマップでこの辺は後でリファクターインクかけるとして、 カラーゼロのアテナですね。 これでマップで、で、ハテナ、ハテナは。 これは論理演算の優先度ですか。 これが丸かっこにして、これで偉そうなことなさそうね。 マップにして、マップが良いのか。 オプショナル、オプショナルで聞いていて、 これに対してマップをするか。 だからここが、なるほど、これが丸かっこで、 ノードのところに丸かっこが。 これは後で直しますよね。 で、これでビルドをかけてあげると、どうすると、 一回、今ので良かった。 ユーザーインフォーもアテナになったか。 ユーザーインフォー、まだ依然としてユーザーインフォーを取ってくる。 こんな状況になってますね。 ユーザーインフォーはなんで取ってくるんだ。 ビジットでノードを渡して、 そのノードがディナムテクルシンタックスの時ですよね。 フォーカーは、ビジッターは、ここでディナムテクレレーションの メンバーブロックを渡せますよね。 メンバーブロックを渡しているのに、 ディナムテクルのメンバーブロックを渡して、 この中ですよね、おそらくね、この中で、 あっちゃ、親を見つけてきたんだろう。 あっちゃ、あっちゃ、大丈夫だ。 ユーザーインフォーが取れていて、だからペアレントだ。 ペアレントでユーザーインフォーを 見つけてきたってことですね、これね。 ああ、なるほど。 エンクロージングイーナムは ちゃんと動いてるってことですね。 ペアレントだと言ってね。 ユーザーインフォーまで行って、 ユーザーインフォーの時には、 これをね、なんとか、なんとか。 だいわけですけど、 だから、ペアレントまで行くのか。 だからこれはオプショナルであり、 必要がまずい。 これ無くなって、 これでダメでしたけどね、さっきね。 これでいいや。 これで選択肢はこれだけ。 えーと、まあ、かっこ悪くはないね。 これが、うん、戻ってきた。 このユーザーインフォー?に、 これが問題だよってことで、 このユーザーインフォー?は 特例としてやる感じですかね。 それと逆に、他の階層も オプショナルにしないというのもあるんですよね。 どうしないかな。 ユーザーインフォー。 今回は、全部必須にしますかね。 明記してますしね、自分でね。 無い場合というものを想定しない。 という形にすると、この派手なのが 要らなくなりますよね。 それで、ここのバーで、 オプショナルではなくなる。 で、ここが、強制アンラップが、 ここがちょっと怖いですね。 強制アンラップ、強制アンラップ。 そうすると、ここは、あるものとするの。 強制アンラップ。 アンラップオプショナルにしましょう。 そうすると、取れますよね。 これでいいや。 見たとなったら、このタイプができるんで、 これで、OK。 そうすると、このマクロの展開。 これがね、ちゃんといい感じにできているはず。 今のところね。 ユーザーインフォーのAPSに対して、 ラストしてね、取ってくる。 で、レストも、ちゃんとね、 APSに対して取ってくる。 うん、できましたね。 こんな風にしてできたので、うん。 まあ、できたんですが、このね、 さっきから言っている、このインデント。 このインデントだけで、気になるんですけどね。 まあ、それはまずはいいや。 じゃあ、こんなんで、大元ができたので、 今日はこれぐらいにして、 次回にこのケースに対して、 プロパティをできて作るというのをね、やっていきますね。 はい。では、これで終わりにしますよ。 お疲れ様でした。
